{"version":3,"sources":["snabbdom-patch.js"],"names":["f","exports","module","define","amd","window","global","self","this","snabbdom","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","Object","defineProperty","value","xlinkNS","xmlNS","attributesApi","listAttrs","elm","attributes","keys","key","nodeName","push","getAttr","getAttribute","setAttr","val","setAttribute","removeAttribute","setAttributeNS","removeAttr","default","2","classApi","addClass","name","classList","add","removeClass","remove","3","CAPS_REGEX","toKey","replace","toLowerCase","datasetApi","listDatas","d","dataset","slice","getData","setData","removeData","4","insertChild","parentNode","newNode","referenceNode","insertBefore","appendChild","removeChild","node","child","firstChild","nextSibling","getSelector","tagName","undefined","setTextContent","text","textContent","getTextContent","isElement","nodeType","isText","isComment","htmlDomApi","document","createElement","tag","id","cls","nsUri","createElementNS","createTextNode","createComment","5","eventListenersApi","addEvent","fn","addEventListener","removeEvent","removeEventListener","6","propsApi","getProp","setProp","removeProp","7","raf","requestAnimationFrame","setTimeout","styleApi","listStyle","style","hasOwnProperty","getStyle","setStyle","next","setProperty","removeStyle","removeProperty","onTransEnd","names","callback","props","getComputedStyle","split","amount","indexOf","ev","target","8","vnode_1","snabbdom_1","h","sel","b","c","children","data","isDef","isArray","isPrimitive","vnode","addNS","ns","childData","./snabbdom","./vnode","9","attributesModule","api","updateAttrs","oldVnode","oldAttrs","attrs","cur","read","_i","keys_1","create","update","10","classModule","updateClass","oldClass","class","newClass","11","datasetModule","updateDataset","oldDataset","datas","12","handleEvent","event","type","on","invokeHandler","handler","args","apply","eventListenersModule","updateEventListeners","oldOn","oldListener","listener","oldElm","destroy","13","propsModule","updateProps","oldProps","14","styleModule","updateStyle","oldStyle","oldHasDel","delayed","name2","rm","applied","15","attributes_1","class_1","props_1","style_1","eventlisteners_1","dataset_1","domapi_1","attributes_2","class_2","props_2","style_2","eventlisteners_2","dataset_2","h_1","snabbdomModules","_a","init","patch","snabbdomBundle","./client/attributes","./client/class","./client/dataset","./client/domapi","./client/eventlisteners","./client/props","./client/style","./h","./modules/attributes","./modules/class","./modules/dataset","./modules/eventlisteners","./modules/props","./modules/style","16","Array","emptyNode","sameVnode","vnode1","vnode2","createKeyToOldIdx","beginIdx","endIdx","ch","map","hooks","modules","j","cbs","hook","createRmCb","childElm","listeners","parent_1","createElm","insertedVnodeQueue","hashIdx","dotIdx","hash","dot","Math","min","insert","addVnodes","parentElm","before","vnodes","startIdx","invokeDestroyHook","removeVnodes","i_1","patchVnode","prepatch","oldCh","newCh","oldKeyToIdx","idxInOld","elmToMove","oldStartIdx","newStartIdx","oldEndIdx","oldStartVnode","oldEndVnode","newEndIdx","newStartVnode","newEndVnode","updateChildren","postpatch","vn","i_2","pre","parent_2","post","17"],"mappings":"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","file":"snabbdom-patch.min.js","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.snabbdom = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar xlinkNS = 'http://www.w3.org/1999/xlink';\nvar xmlNS = 'http://www.w3.org/XML/1998/namespace';\nfunction listAttrs(elm) {\n    var attributes = elm.attributes;\n    var keys = [];\n    for (var i = 0, n = attributes.length; i < n; i++) {\n        var key = attributes[i].nodeName;\n        keys.push(key);\n    }\n    return keys;\n}\nfunction getAttr(elm, key) {\n    return elm.getAttribute(key);\n}\nfunction setAttr(elm, key, val) {\n    if (val === true) {\n        elm.setAttribute(key, \"\");\n    }\n    else if (val === false) {\n        elm.removeAttribute(key);\n    }\n    else {\n        if (key[0] != 'x') {\n            elm.setAttribute(key, val);\n        }\n        else if (key[3] == ':') {\n            // Assume xml namespace\n            elm.setAttributeNS(xmlNS, key, val);\n        }\n        else if (key[5] == ':') {\n            // Assume xlink namespace\n            elm.setAttributeNS(xlinkNS, key, val);\n        }\n        else {\n            elm.setAttribute(key, val);\n        }\n    }\n}\nfunction removeAttr(elm, key) {\n    elm.removeAttribute(key);\n}\nexports.attributesApi = { listAttrs: listAttrs, getAttr: getAttr, setAttr: setAttr, removeAttr: removeAttr };\nexports.default = exports.attributesApi;\n\n},{}],2:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction addClass(elm, name) {\n    elm.classList.add(name);\n}\nfunction removeClass(elm, name) {\n    elm.classList.remove(name);\n}\nexports.classApi = { addClass: addClass, removeClass: removeClass };\nexports.default = exports.classApi;\n\n},{}],3:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar CAPS_REGEX = /[A-Z]/g;\nfunction toKey(key) {\n    return key.replace(CAPS_REGEX, '-$&').toLowerCase();\n}\nfunction listDatas(elm) {\n    var d = elm.dataset;\n    if (d) {\n        return Object.keys(d);\n    }\n    else {\n        var keys = [];\n        var attributes = elm.attributes;\n        for (var i = 0, n = attributes.length; i < n; i++) {\n            var key = attributes[i].nodeName;\n            if (key.length > 5 && key[4] == '-' && key[0] == 'd' && key[1] == 'a' && key[2] == 't' && key[3] == 'a') {\n                keys.push(key.slice(5));\n            }\n        }\n        return keys;\n    }\n}\nfunction getData(elm, key) {\n    var d = elm.dataset;\n    return (d ? d[key] : elm.getAttribute(\"data-\" + key));\n}\nfunction setData(elm, key, val) {\n    var d = elm.dataset;\n    if (d) {\n        d[key] = val;\n    }\n    else {\n        elm.setAttribute(\"data-\" + toKey(key), val);\n    }\n}\nfunction removeData(elm, key) {\n    var d = elm.dataset;\n    if (d) {\n        if (key in d) {\n            delete d[key];\n        }\n    }\n    else {\n        elm.removeAttribute(\"data-\" + toKey(key));\n    }\n}\nexports.datasetApi = { listDatas: listDatas, getData: getData, setData: setData, removeData: removeData };\nexports.default = exports.datasetApi;\n\n},{}],4:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction insertChild(parentNode, newNode, referenceNode) {\n    if (referenceNode) {\n        parentNode.insertBefore(newNode, referenceNode);\n    }\n    else {\n        parentNode.appendChild(newNode);\n    }\n}\nfunction removeChild(node, child) {\n    node.removeChild(child);\n}\nfunction parentNode(node) {\n    return node.parentNode;\n}\nfunction firstChild(node) {\n    return node.firstChild;\n}\nfunction nextSibling(node) {\n    return node.nextSibling;\n}\nfunction getSelector(elm) {\n    return [\n        elm.tagName.toLowerCase(),\n        elm.getAttribute('id') || undefined,\n        elm.getAttribute('class') || undefined,\n    ];\n}\nfunction setTextContent(node, text) {\n    node.textContent = text;\n}\nfunction getTextContent(node) {\n    return node.textContent;\n}\nfunction isElement(node) {\n    return node.nodeType === 1;\n}\nfunction isText(node) {\n    return node.nodeType === 3;\n}\nfunction isComment(node) {\n    return node.nodeType === 8;\n}\nfunction htmlDomApi(document) {\n    function createElement(tag, id, cls, nsUri) {\n        var elm = nsUri ? document.createElementNS(nsUri, tag) : document.createElement(tag);\n        if (id)\n            elm.setAttribute('id', id);\n        if (cls)\n            elm.setAttribute('class', cls);\n        return elm;\n    }\n    function createTextNode(text) {\n        return document.createTextNode(text);\n    }\n    function createComment(text) {\n        return document.createComment(text);\n    }\n    return {\n        createElement: createElement,\n        createTextNode: createTextNode,\n        createComment: createComment,\n        insertChild: insertChild,\n        removeChild: removeChild,\n        parentNode: parentNode,\n        firstChild: firstChild,\n        nextSibling: nextSibling,\n        getSelector: getSelector,\n        setTextContent: setTextContent,\n        getTextContent: getTextContent,\n        isElement: isElement,\n        isText: isText,\n        isComment: isComment,\n    };\n}\nexports.htmlDomApi = htmlDomApi;\nexports.default = htmlDomApi;\n\n},{}],5:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction addEvent(elm, name, fn) {\n    elm.addEventListener(name, fn, false);\n}\nfunction removeEvent(elm, name, fn) {\n    elm.removeEventListener(name, fn, false);\n}\nexports.eventListenersApi = { addEvent: addEvent, removeEvent: removeEvent };\nexports.default = exports.eventListenersApi;\n\n},{}],6:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction getProp(elm, key) {\n    return elm[key];\n}\nfunction setProp(elm, key, val) {\n    elm[key] = val;\n}\nfunction removeProp(elm, key) {\n    delete elm[key];\n}\nexports.propsApi = { getProp: getProp, setProp: setProp, removeProp: removeProp };\nexports.default = exports.propsApi;\n\n},{}],7:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar raf = (typeof window !== 'undefined' && window.requestAnimationFrame) || setTimeout;\nfunction nextFrame(fn) {\n    raf(function () {\n        raf(fn);\n    });\n}\nfunction listStyle(elm) {\n    var style = elm.style;\n    var keys = [];\n    for (var key in style) {\n        if (style.hasOwnProperty(key)) {\n            keys.push(key);\n        }\n    }\n    return keys;\n}\nfunction getStyle(elm, name) {\n    return elm.style[name];\n}\nfunction setStyle(elm, name, val, next) {\n    if (next === void 0) { next = false; }\n    var fn = name[0] === '-' && name[1] === '-' ?\n        function () {\n            elm.style.setProperty(name, val);\n        } : function () {\n        elm.style[name] = val;\n    };\n    if (!next) {\n        fn();\n    }\n    else {\n        nextFrame(fn);\n    }\n}\nfunction removeStyle(elm, name) {\n    if (name[0] == '-' && name[1] == '-') {\n        elm.style.removeProperty(name);\n    }\n    else {\n        elm.style[name] = '';\n    }\n}\nfunction onTransEnd(elm, names, callback) {\n    var compStyle = getComputedStyle(elm);\n    var props = compStyle['transition-property'].split(', ');\n    var amount = 0;\n    for (var i = 0; i < props.length; ++i) {\n        if (names.indexOf(props[i]) !== -1)\n            amount++;\n    }\n    elm.addEventListener('transitionend', function (ev) {\n        if (ev.target === elm)\n            --amount;\n        if (amount === 0)\n            callback();\n    });\n}\nexports.styleApi = { listStyle: listStyle, getStyle: getStyle, setStyle: setStyle, removeStyle: removeStyle, onTransEnd: onTransEnd };\nexports.default = exports.styleApi;\n\n},{}],8:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar vnode_1 = require(\"./vnode\");\nvar snabbdom_1 = require(\"./snabbdom\");\nfunction addNS(data, children, sel) {\n    data.ns = 'http://www.w3.org/2000/svg';\n    if (sel !== 'foreignObject' && snabbdom_1.isDef(children)) {\n        for (var i = 0; i < children.length; ++i) {\n            var childData = children[i].data;\n            if (snabbdom_1.isDef(childData)) {\n                addNS(childData, children[i].children, children[i].sel);\n            }\n        }\n    }\n}\nfunction h(sel, b, c) {\n    var data = {}, children, text, i;\n    if (snabbdom_1.isDef(c)) {\n        data = b;\n        if (snabbdom_1.isArray(c)) {\n            children = c;\n        }\n        else if (snabbdom_1.isPrimitive(c)) {\n            text = c;\n        }\n        else if (c && c.sel) {\n            children = [c];\n        }\n    }\n    else if (snabbdom_1.isDef(b)) {\n        if (snabbdom_1.isArray(b)) {\n            children = b;\n        }\n        else if (snabbdom_1.isPrimitive(b)) {\n            text = b;\n        }\n        else if (b && b.sel) {\n            children = [b];\n        }\n        else {\n            data = b;\n        }\n    }\n    if (snabbdom_1.isArray(children)) {\n        for (i = 0; i < children.length; ++i) {\n            if (snabbdom_1.isPrimitive(children[i]))\n                children[i] = vnode_1.vnode(undefined, undefined, undefined, children[i], undefined);\n        }\n    }\n    if (sel[0] === 's' && sel[1] === 'v' && sel[2] === 'g' &&\n        (sel.length === 3 || sel[3] === '.' || sel[3] === '#')) {\n        addNS(data, children, sel);\n    }\n    return vnode_1.vnode(sel, data, children, text, undefined);\n}\nexports.h = h;\n;\nexports.default = h;\n\n},{\"./snabbdom\":16,\"./vnode\":17}],9:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction attributesModule(api) {\n    function readAttrs(vnode) {\n        var elm = vnode.elm, keys = api.listAttrs(elm), attrs = {};\n        for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n            var key = keys_1[_i];\n            if (key != 'id' && key != 'class' &&\n                !(key.length > 5 && key[4] == '-' && key[0] == 'd' && key[1] == 'a' && key[2] == 't' && key[3] == 'a')) {\n                attrs[key] = api.getAttr(elm, key);\n            }\n        }\n        vnode.data.attrs = attrs;\n    }\n    function updateAttrs(oldVnode, vnode) {\n        var elm = vnode.elm;\n        var key, oldAttrs = oldVnode.data.attrs, attrs = vnode.data.attrs;\n        if (!oldAttrs && !attrs)\n            return;\n        if (oldAttrs === attrs)\n            return;\n        oldAttrs = oldAttrs || {};\n        attrs = attrs || {};\n        // update modified attributes, add new attributes\n        for (key in attrs) {\n            var cur = attrs[key];\n            var old = oldAttrs[key];\n            if (old !== cur) {\n                api.setAttr(elm, key, cur);\n            }\n        }\n        // remove removed attributes\n        // use `in` operator since the previous `for` iteration uses it (.i.e. add even attributes with undefined value)\n        // the other option is to remove all attributes with value == undefined\n        for (key in oldAttrs) {\n            if (!(key in attrs)) {\n                api.removeAttr(elm, key);\n            }\n        }\n    }\n    return { read: readAttrs, create: updateAttrs, update: updateAttrs };\n}\nexports.attributesModule = attributesModule;\nexports.default = attributesModule;\n\n},{}],10:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction classModule(api) {\n    function updateClass(oldVnode, vnode) {\n        var elm = vnode.elm;\n        var cur, name, oldClass = oldVnode.data.class, newClass = vnode.data.class;\n        if (!oldClass && !newClass)\n            return;\n        if (oldClass === newClass)\n            return;\n        oldClass = oldClass || {};\n        newClass = newClass || {};\n        for (name in oldClass) {\n            if (!newClass[name]) {\n                api.removeClass(elm, name);\n            }\n        }\n        for (name in newClass) {\n            cur = newClass[name];\n            if (cur !== oldClass[name]) {\n                api[cur ? 'addClass' : 'removeClass'](elm, name);\n            }\n        }\n    }\n    return { create: updateClass, update: updateClass };\n}\nexports.classModule = classModule;\nexports.default = classModule;\n\n},{}],11:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction datasetModule(api) {\n    function readDataset(vnode) {\n        var elm = vnode.elm, keys = api.listDatas(elm), datas = {};\n        for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n            var key = keys_1[_i];\n            datas[key] = api.getData(elm, key);\n        }\n        vnode.data.dataset = datas;\n    }\n    function updateDataset(oldVnode, vnode) {\n        var elm = vnode.elm, oldDataset = oldVnode.data.dataset, dataset = vnode.data.dataset, key;\n        if (!oldDataset && !dataset)\n            return;\n        if (oldDataset === dataset)\n            return;\n        oldDataset = oldDataset || {};\n        dataset = dataset || {};\n        for (key in oldDataset) {\n            if (!dataset[key]) {\n                api.removeData(elm, key);\n            }\n        }\n        for (key in dataset) {\n            if (oldDataset[key] !== dataset[key]) {\n                api.setData(elm, key, dataset[key]);\n            }\n        }\n    }\n    return { read: readDataset, create: updateDataset, update: updateDataset };\n}\nexports.datasetModule = datasetModule;\nexports.default = datasetModule;\n\n},{}],12:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction invokeHandler(handler, vnode, event) {\n    if (typeof handler === \"function\") {\n        // call function handler\n        handler.call(vnode, event, vnode);\n    }\n    else if (typeof handler === \"object\") {\n        // call handler with arguments\n        if (typeof handler[0] === \"function\") {\n            // special case for single argument for performance\n            if (handler.length === 2) {\n                handler[0].call(vnode, handler[1], event, vnode);\n            }\n            else {\n                var args = handler.slice(1);\n                args.push(event);\n                args.push(vnode);\n                handler[0].apply(vnode, args);\n            }\n        }\n        else {\n            // call multiple handlers\n            for (var i = 0; i < handler.length; i++) {\n                invokeHandler(handler[i]);\n            }\n        }\n    }\n}\nfunction handleEvent(event, vnode) {\n    var name = event.type, on = vnode.data.on;\n    // call event handler(s) if exists\n    if (on && on[name]) {\n        invokeHandler(on[name], vnode, event);\n    }\n}\nfunction createListener() {\n    return function handler(event) {\n        handleEvent(event, handler.vnode);\n    };\n}\nfunction eventListenersModule(api) {\n    function updateEventListeners(oldVnode, vnode) {\n        var oldOn = oldVnode.data.on, oldListener = oldVnode.listener, oldElm = oldVnode.elm, on = vnode && vnode.data.on, elm = (vnode && vnode.elm);\n        var name;\n        // optimization for reused immutable handlers\n        if (oldOn === on) {\n            return;\n        }\n        // remove existing listeners which no longer used\n        if (oldOn && oldListener) {\n            // if element changed or deleted we remove all existing listeners unconditionally\n            if (!on) {\n                for (name in oldOn) {\n                    // remove listener if element was changed or existing listeners removed\n                    api.removeEvent(oldElm, name, oldListener);\n                }\n            }\n            else {\n                for (name in oldOn) {\n                    // remove listener if existing listener removed\n                    if (!on[name]) {\n                        api.removeEvent(oldElm, name, oldListener);\n                    }\n                }\n            }\n        }\n        // add new listeners which has not already attached\n        if (on) {\n            // reuse existing listener or create new\n            var listener = vnode.listener = oldVnode.listener || createListener();\n            // update vnode for listener\n            listener.vnode = vnode;\n            // if element changed or added we add all needed listeners unconditionally\n            if (!oldOn) {\n                for (name in on) {\n                    // add listener if element was changed or new listeners added\n                    api.addEvent(elm, name, listener);\n                }\n            }\n            else {\n                for (name in on) {\n                    // add listener if new listener added\n                    if (!oldOn[name]) {\n                        api.addEvent(elm, name, listener);\n                    }\n                }\n            }\n        }\n    }\n    return {\n        create: updateEventListeners,\n        update: updateEventListeners,\n        destroy: updateEventListeners\n    };\n}\nexports.eventListenersModule = eventListenersModule;\nexports.default = eventListenersModule;\n\n},{}],13:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction propsModule(api) {\n    function updateProps(oldVnode, vnode) {\n        var elm = vnode.elm;\n        var key, cur, old, oldProps = oldVnode.data.props, props = vnode.data.props;\n        if (!oldProps && !props)\n            return;\n        if (oldProps === props)\n            return;\n        oldProps = oldProps || {};\n        props = props || {};\n        for (key in oldProps) {\n            if (!props[key]) {\n                api.removeProp(elm, key);\n            }\n        }\n        for (key in props) {\n            cur = props[key];\n            old = oldProps[key];\n            if (old !== cur && (key !== 'value' || api.getProp(elm, key) !== cur)) {\n                api.setProp(elm, key, cur);\n            }\n        }\n    }\n    return { create: updateProps, update: updateProps };\n}\nexports.propsModule = propsModule;\nexports.default = propsModule;\n\n},{}],14:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction styleModule(api) {\n    function readStyle(vnode) {\n        var elm = vnode.elm;\n        var keys = api.listStyle(elm);\n        var style = {};\n        for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n            var key = keys_1[_i];\n            style[key] = api.getStyle(elm, key);\n        }\n        vnode.data.style = style;\n    }\n    function updateStyle(oldVnode, vnode) {\n        var elm = vnode.elm;\n        var cur, name, oldStyle = oldVnode.data.style, style = vnode.data.style;\n        if (!oldStyle && !style)\n            return;\n        if (oldStyle === style)\n            return;\n        oldStyle = oldStyle || {};\n        style = style || {};\n        var oldHasDel = 'delayed' in oldStyle;\n        for (name in oldStyle) {\n            if (!style[name]) {\n                api.removeStyle(elm, name);\n            }\n        }\n        for (name in style) {\n            cur = style[name];\n            if (name === 'delayed' && style.delayed) {\n                for (var name2 in style.delayed) {\n                    cur = style.delayed[name2];\n                    if (!oldHasDel || cur !== oldStyle.delayed[name2]) {\n                        api.setStyle(elm, name2, cur, true);\n                    }\n                }\n            }\n            else if (name !== 'remove' && cur !== oldStyle[name]) {\n                api.setStyle(elm, name, cur);\n            }\n        }\n    }\n    function applyDestroyStyle(vnode) {\n        var elm = vnode.elm, s = vnode.data.style;\n        var style, name;\n        if (!s || !(style = s.destroy))\n            return;\n        for (name in style) {\n            api.setStyle(elm, name, style[name]);\n        }\n    }\n    function applyRemoveStyle(vnode, rm) {\n        var s = vnode.data.style;\n        if (!s || !s.remove) {\n            rm();\n            return;\n        }\n        var elm = vnode.elm, style = s.remove, applied = [];\n        var name;\n        for (name in style) {\n            applied.push(name);\n            api.setStyle(elm, name, style[name]);\n        }\n        api.onTransEnd(elm, applied, rm);\n    }\n    return {\n        read: readStyle,\n        create: updateStyle,\n        update: updateStyle,\n        destroy: applyDestroyStyle,\n        remove: applyRemoveStyle\n    };\n}\nexports.styleModule = styleModule;\nexports.default = styleModule;\n\n},{}],15:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar snabbdom_1 = require(\"./snabbdom\");\nvar attributes_1 = require(\"./modules/attributes\"); // for setting attributes on DOM elements\nvar class_1 = require(\"./modules/class\"); // makes it easy to toggle classes\nvar props_1 = require(\"./modules/props\"); // for setting properties on DOM elements\nvar style_1 = require(\"./modules/style\"); // handles styling on elements with support for animations\nvar eventlisteners_1 = require(\"./modules/eventlisteners\"); // attaches event listeners\nvar dataset_1 = require(\"./modules/dataset\"); // handles dataset\nvar domapi_1 = require(\"./client/domapi\"); // browser DOM API\nvar attributes_2 = require(\"./client/attributes\");\nvar class_2 = require(\"./client/class\");\nvar props_2 = require(\"./client/props\");\nvar style_2 = require(\"./client/style\");\nvar eventlisteners_2 = require(\"./client/eventlisteners\");\nvar dataset_2 = require(\"./client/dataset\");\nvar h_1 = require(\"./h\"); // helper function for creating vnodes\nexports.snabbdomModules = [\n    attributes_1.attributesModule(attributes_2.attributesApi),\n    class_1.classModule(class_2.classApi),\n    props_1.propsModule(props_2.propsApi),\n    style_1.styleModule(style_2.styleApi),\n    eventlisteners_1.eventListenersModule(eventlisteners_2.eventListenersApi),\n    dataset_1.datasetModule(dataset_2.datasetApi),\n];\n// Init patch function with choosen modules\nvar _a = snabbdom_1.init(exports.snabbdomModules, domapi_1.htmlDomApi(document)), read = _a.read, patch = _a.patch;\nexports.snabbdomBundle = { read: read, patch: patch, h: h_1.h };\nexports.default = exports.snabbdomBundle;\n\n},{\"./client/attributes\":1,\"./client/class\":2,\"./client/dataset\":3,\"./client/domapi\":4,\"./client/eventlisteners\":5,\"./client/props\":6,\"./client/style\":7,\"./h\":8,\"./modules/attributes\":9,\"./modules/class\":10,\"./modules/dataset\":11,\"./modules/eventlisteners\":12,\"./modules/props\":13,\"./modules/style\":14,\"./snabbdom\":16}],16:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar vnode_1 = require(\"./vnode\");\nexports.isArray = Array.isArray;\nfunction isPrimitive(s) {\n    var t = (typeof s)[0];\n    return t == 's' || t == 'n' || t == 'b';\n}\nexports.isPrimitive = isPrimitive;\nfunction isDef(s) {\n    return s !== undefined;\n}\nexports.isDef = isDef;\nvar emptyNode = vnode_1.vnode('', {}, [], undefined, undefined);\nfunction sameVnode(vnode1, vnode2) {\n    return vnode1.key === vnode2.key && vnode1.sel === vnode2.sel;\n}\nfunction createKeyToOldIdx(children, beginIdx, endIdx) {\n    var i, map = {}, key, ch;\n    for (i = beginIdx; i <= endIdx; ++i) {\n        ch = children[i];\n        if (ch != null) {\n            key = ch.key;\n            if (isDef(key))\n                map[key] = i;\n        }\n    }\n    return map;\n}\nvar hooks = ['read', 'create', 'update', 'remove', 'destroy', 'pre', 'post'];\nfunction init(modules, api) {\n    var i, j, cbs = {};\n    for (i = 0; i < hooks.length; ++i) {\n        cbs[hooks[i]] = [];\n        for (j = 0; j < modules.length; ++j) {\n            var hook = modules[j][hooks[i]];\n            if (isDef(hook)) {\n                cbs[hooks[i]].push(hook);\n            }\n        }\n    }\n    function createRmCb(childElm, listeners) {\n        return function rmCb() {\n            if (--listeners === 0) {\n                var parent_1 = api.parentNode(childElm);\n                api.removeChild(parent_1, childElm);\n            }\n        };\n    }\n    function createElm(vnode, insertedVnodeQueue) {\n        var i, data = vnode.data;\n        if (isDef(data)) {\n            if (isDef(i = data.hook) && isDef(i = i.init)) {\n                i(vnode);\n                data = vnode.data;\n            }\n        }\n        var children = vnode.children, sel = vnode.sel;\n        if (sel === '!') {\n            if (!isDef(vnode.text)) {\n                vnode.text = '';\n            }\n            vnode.elm = api.createComment(vnode.text);\n        }\n        else if (isDef(sel)) {\n            // Parse selector\n            var hashIdx = sel.indexOf('#');\n            var dotIdx = sel.indexOf('.', hashIdx);\n            var hash = hashIdx > 0 ? hashIdx : sel.length;\n            var dot = dotIdx > 0 ? dotIdx : sel.length;\n            var tag = hashIdx !== -1 || dotIdx !== -1 ? sel.slice(0, Math.min(hash, dot)) : sel;\n            var elm = vnode.elm = api.createElement(tag, hash < dot ? sel.slice(hash + 1, dot) : undefined, dotIdx > 0 ? sel.slice(dot + 1).replace(/\\./g, ' ') : undefined, isDef(data) ? data.ns : undefined);\n            for (i = 0; i < cbs.create.length; ++i)\n                cbs.create[i](emptyNode, vnode);\n            if (exports.isArray(children)) {\n                for (i = 0; i < children.length; ++i) {\n                    var ch = children[i];\n                    if (ch != null) {\n                        api.insertChild(elm, createElm(ch, insertedVnodeQueue));\n                    }\n                }\n            }\n            else if (isPrimitive(vnode.text)) {\n                api.insertChild(elm, api.createTextNode(vnode.text));\n            }\n            i = vnode.data.hook; // Reuse variable\n            if (isDef(i)) {\n                if (i.create)\n                    i.create(emptyNode, vnode);\n                if (i.insert)\n                    insertedVnodeQueue.push(vnode);\n            }\n        }\n        else {\n            vnode.elm = api.createTextNode(vnode.text);\n        }\n        return vnode.elm;\n    }\n    function addVnodes(parentElm, before, vnodes, startIdx, endIdx, insertedVnodeQueue) {\n        for (; startIdx <= endIdx; ++startIdx) {\n            var ch = vnodes[startIdx];\n            if (ch != null) {\n                api.insertChild(parentElm, createElm(ch, insertedVnodeQueue), before);\n            }\n        }\n    }\n    function invokeDestroyHook(vnode) {\n        var i, j, data = vnode.data;\n        if (isDef(data)) {\n            if (isDef(i = data.hook) && isDef(i = i.destroy))\n                i(vnode);\n            for (i = 0; i < cbs.destroy.length; ++i)\n                cbs.destroy[i](vnode);\n            if (isDef(vnode.children)) {\n                for (j = 0; j < vnode.children.length; ++j) {\n                    i = vnode.children[j];\n                    if (i != null && typeof i !== \"string\") {\n                        invokeDestroyHook(i);\n                    }\n                }\n            }\n        }\n    }\n    function removeVnodes(parentElm, vnodes, startIdx, endIdx) {\n        for (; startIdx <= endIdx; ++startIdx) {\n            var i_1 = void 0, listeners = void 0, rm = void 0, ch = vnodes[startIdx];\n            if (ch != null) {\n                if (isDef(ch.sel)) {\n                    invokeDestroyHook(ch);\n                    listeners = cbs.remove.length + 1;\n                    rm = createRmCb(ch.elm, listeners);\n                    for (i_1 = 0; i_1 < cbs.remove.length; ++i_1)\n                        cbs.remove[i_1](ch, rm);\n                    if (isDef(i_1 = ch.data) && isDef(i_1 = i_1.hook) && isDef(i_1 = i_1.remove)) {\n                        i_1(ch, rm);\n                    }\n                    else {\n                        rm();\n                    }\n                }\n                else {\n                    api.removeChild(parentElm, ch.elm);\n                }\n            }\n        }\n    }\n    function updateChildren(parentElm, oldCh, newCh, insertedVnodeQueue) {\n        var oldStartIdx = 0, newStartIdx = 0;\n        var oldEndIdx = oldCh.length - 1;\n        var oldStartVnode = oldCh[0];\n        var oldEndVnode = oldCh[oldEndIdx];\n        var newEndIdx = newCh.length - 1;\n        var newStartVnode = newCh[0];\n        var newEndVnode = newCh[newEndIdx];\n        var oldKeyToIdx;\n        var idxInOld;\n        var elmToMove;\n        var before;\n        while (oldStartIdx <= oldEndIdx && newStartIdx <= newEndIdx) {\n            if (oldStartVnode == null) {\n                oldStartVnode = oldCh[++oldStartIdx]; // Vnode might have been moved left\n            }\n            else if (oldEndVnode == null) {\n                oldEndVnode = oldCh[--oldEndIdx];\n            }\n            else if (newStartVnode == null) {\n                newStartVnode = newCh[++newStartIdx];\n            }\n            else if (newEndVnode == null) {\n                newEndVnode = newCh[--newEndIdx];\n            }\n            else if (sameVnode(oldStartVnode, newStartVnode)) {\n                patchVnode(oldStartVnode, newStartVnode, insertedVnodeQueue);\n                oldStartVnode = oldCh[++oldStartIdx];\n                newStartVnode = newCh[++newStartIdx];\n            }\n            else if (sameVnode(oldEndVnode, newEndVnode)) {\n                patchVnode(oldEndVnode, newEndVnode, insertedVnodeQueue);\n                oldEndVnode = oldCh[--oldEndIdx];\n                newEndVnode = newCh[--newEndIdx];\n            }\n            else if (sameVnode(oldStartVnode, newEndVnode)) {\n                patchVnode(oldStartVnode, newEndVnode, insertedVnodeQueue);\n                api.insertChild(parentElm, oldStartVnode.elm, api.nextSibling(oldEndVnode.elm));\n                oldStartVnode = oldCh[++oldStartIdx];\n                newEndVnode = newCh[--newEndIdx];\n            }\n            else if (sameVnode(oldEndVnode, newStartVnode)) {\n                patchVnode(oldEndVnode, newStartVnode, insertedVnodeQueue);\n                api.insertChild(parentElm, oldEndVnode.elm, oldStartVnode.elm);\n                oldEndVnode = oldCh[--oldEndIdx];\n                newStartVnode = newCh[++newStartIdx];\n            }\n            else {\n                if (oldKeyToIdx === undefined) {\n                    oldKeyToIdx = createKeyToOldIdx(oldCh, oldStartIdx, oldEndIdx);\n                }\n                idxInOld = oldKeyToIdx[newStartVnode.key];\n                if (!isDef(idxInOld)) {\n                    api.insertChild(parentElm, createElm(newStartVnode, insertedVnodeQueue), oldStartVnode.elm);\n                    newStartVnode = newCh[++newStartIdx];\n                }\n                else {\n                    elmToMove = oldCh[idxInOld];\n                    if (elmToMove.sel !== newStartVnode.sel) {\n                        api.insertChild(parentElm, createElm(newStartVnode, insertedVnodeQueue), oldStartVnode.elm);\n                    }\n                    else {\n                        patchVnode(elmToMove, newStartVnode, insertedVnodeQueue);\n                        oldCh[idxInOld] = undefined;\n                        api.insertChild(parentElm, elmToMove.elm, oldStartVnode.elm);\n                    }\n                    newStartVnode = newCh[++newStartIdx];\n                }\n            }\n        }\n        if (oldStartIdx <= oldEndIdx || newStartIdx <= newEndIdx) {\n            if (oldStartIdx > oldEndIdx) {\n                before = newCh[newEndIdx + 1] == null ? null : newCh[newEndIdx + 1].elm;\n                addVnodes(parentElm, before, newCh, newStartIdx, newEndIdx, insertedVnodeQueue);\n            }\n            else {\n                removeVnodes(parentElm, oldCh, oldStartIdx, oldEndIdx);\n            }\n        }\n    }\n    function patchVnode(oldVnode, vnode, insertedVnodeQueue) {\n        var i, hook;\n        if (isDef(i = vnode.data) && isDef(hook = i.hook) && isDef(i = hook.prepatch)) {\n            i(oldVnode, vnode);\n        }\n        var elm = vnode.elm = oldVnode.elm;\n        var oldCh = oldVnode.children;\n        var ch = vnode.children;\n        if (oldVnode === vnode)\n            return;\n        if (isDef(vnode.data)) {\n            for (i = 0; i < cbs.update.length; ++i)\n                cbs.update[i](oldVnode, vnode);\n            i = vnode.data.hook;\n            if (isDef(i) && isDef(i = i.update))\n                i(oldVnode, vnode);\n        }\n        if (!isDef(vnode.text)) {\n            if (isDef(oldCh) && isDef(ch)) {\n                if (oldCh !== ch)\n                    updateChildren(elm, oldCh, ch, insertedVnodeQueue);\n            }\n            else if (isDef(ch)) {\n                if (isDef(oldVnode.text))\n                    api.setTextContent(elm, '');\n                addVnodes(elm, null, ch, 0, ch.length - 1, insertedVnodeQueue);\n            }\n            else if (isDef(oldCh)) {\n                removeVnodes(elm, oldCh, 0, oldCh.length - 1);\n            }\n            else if (isDef(oldVnode.text)) {\n                api.setTextContent(elm, '');\n            }\n        }\n        else if (oldVnode.text !== vnode.text) {\n            api.setTextContent(elm, vnode.text);\n        }\n        if (isDef(hook) && isDef(i = hook.postpatch)) {\n            i(oldVnode, vnode);\n        }\n    }\n    function patch(oldVnode, vnode) {\n        var i;\n        var insertedVnodeQueue = [];\n        for (i = 0; i < cbs.pre.length; ++i)\n            cbs.pre[i]();\n        if (sameVnode(oldVnode, vnode)) {\n            patchVnode(oldVnode, vnode, insertedVnodeQueue);\n        }\n        else {\n            var elm = oldVnode.elm;\n            var parent_2 = api.parentNode(elm);\n            createElm(vnode, insertedVnodeQueue);\n            if (parent_2 !== null) {\n                api.insertChild(parent_2, vnode.elm, api.nextSibling(elm));\n                removeVnodes(parent_2, [oldVnode], 0, 0);\n            }\n        }\n        for (i = 0; i < insertedVnodeQueue.length; ++i) {\n            insertedVnodeQueue[i].data.hook.insert(insertedVnodeQueue[i]);\n        }\n        for (i = 0; i < cbs.post.length; ++i)\n            cbs.post[i]();\n        return vnode;\n    }\n    ;\n    function read(node) {\n        var text;\n        if (api.isElement(node)) {\n            var _a = api.getSelector(node), tag = _a[0], id = _a[1], cls = _a[2];\n            var sel = \"\" + tag + (id ? '#' + id : '') + (cls ? '.' + cls.replace(/ /, '.') : '');\n            var children = [];\n            for (var child = api.firstChild(node); child != null; child = api.nextSibling(child)) {\n                children.push(read(child));\n            }\n            var vn = vnode_1.vnode(sel, {}, children, undefined, node);\n            for (var i_2 = 0; i_2 < cbs.read.length; ++i_2)\n                cbs.read[i_2](vn);\n            return vn;\n        }\n        else if (api.isText(node)) {\n            text = api.getTextContent(node);\n            return vnode_1.vnode(undefined, undefined, undefined, text, node);\n        }\n        else if (api.isComment(node)) {\n            text = api.getTextContent(node);\n            return vnode_1.vnode('!', {}, [], text, node);\n        }\n        else {\n            return vnode_1.vnode('', {}, [], undefined, node);\n        }\n    }\n    return { read: read, patch: patch };\n}\nexports.init = init;\n\n},{\"./vnode\":17}],17:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction vnode(sel, data, children, text, elm) {\n    var key = data === undefined ? undefined : data.key;\n    return {\n        sel: sel, data: data, children: children,\n        text: text, elm: elm, key: key\n    };\n}\nexports.vnode = vnode;\nexports.default = vnode;\n\n},{}]},{},[15])(15)\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJjbGllbnQvYXR0cmlidXRlcy5qcyIsImNsaWVudC9jbGFzcy5qcyIsImNsaWVudC9kYXRhc2V0LmpzIiwiY2xpZW50L2RvbWFwaS5qcyIsImNsaWVudC9ldmVudGxpc3RlbmVycy5qcyIsImNsaWVudC9wcm9wcy5qcyIsImNsaWVudC9zdHlsZS5qcyIsImguanMiLCJtb2R1bGVzL2F0dHJpYnV0ZXMuanMiLCJtb2R1bGVzL2NsYXNzLmpzIiwibW9kdWxlcy9kYXRhc2V0LmpzIiwibW9kdWxlcy9ldmVudGxpc3RlbmVycy5qcyIsIm1vZHVsZXMvcHJvcHMuanMiLCJtb2R1bGVzL3N0eWxlLmpzIiwic25hYmJkb20uYnVuZGxlLmpzIiwic25hYmJkb20uanMiLCJ2bm9kZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDYkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHhsaW5rTlMgPSAnaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayc7XG52YXIgeG1sTlMgPSAnaHR0cDovL3d3dy53My5vcmcvWE1MLzE5OTgvbmFtZXNwYWNlJztcbmZ1bmN0aW9uIGxpc3RBdHRycyhlbG0pIHtcbiAgICB2YXIgYXR0cmlidXRlcyA9IGVsbS5hdHRyaWJ1dGVzO1xuICAgIHZhciBrZXlzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDAsIG4gPSBhdHRyaWJ1dGVzLmxlbmd0aDsgaSA8IG47IGkrKykge1xuICAgICAgICB2YXIga2V5ID0gYXR0cmlidXRlc1tpXS5ub2RlTmFtZTtcbiAgICAgICAga2V5cy5wdXNoKGtleSk7XG4gICAgfVxuICAgIHJldHVybiBrZXlzO1xufVxuZnVuY3Rpb24gZ2V0QXR0cihlbG0sIGtleSkge1xuICAgIHJldHVybiBlbG0uZ2V0QXR0cmlidXRlKGtleSk7XG59XG5mdW5jdGlvbiBzZXRBdHRyKGVsbSwga2V5LCB2YWwpIHtcbiAgICBpZiAodmFsID09PSB0cnVlKSB7XG4gICAgICAgIGVsbS5zZXRBdHRyaWJ1dGUoa2V5LCBcIlwiKTtcbiAgICB9XG4gICAgZWxzZSBpZiAodmFsID09PSBmYWxzZSkge1xuICAgICAgICBlbG0ucmVtb3ZlQXR0cmlidXRlKGtleSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAoa2V5WzBdICE9ICd4Jykge1xuICAgICAgICAgICAgZWxtLnNldEF0dHJpYnV0ZShrZXksIHZhbCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoa2V5WzNdID09ICc6Jykge1xuICAgICAgICAgICAgLy8gQXNzdW1lIHhtbCBuYW1lc3BhY2VcbiAgICAgICAgICAgIGVsbS5zZXRBdHRyaWJ1dGVOUyh4bWxOUywga2V5LCB2YWwpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGtleVs1XSA9PSAnOicpIHtcbiAgICAgICAgICAgIC8vIEFzc3VtZSB4bGluayBuYW1lc3BhY2VcbiAgICAgICAgICAgIGVsbS5zZXRBdHRyaWJ1dGVOUyh4bGlua05TLCBrZXksIHZhbCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBlbG0uc2V0QXR0cmlidXRlKGtleSwgdmFsKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHJlbW92ZUF0dHIoZWxtLCBrZXkpIHtcbiAgICBlbG0ucmVtb3ZlQXR0cmlidXRlKGtleSk7XG59XG5leHBvcnRzLmF0dHJpYnV0ZXNBcGkgPSB7IGxpc3RBdHRyczogbGlzdEF0dHJzLCBnZXRBdHRyOiBnZXRBdHRyLCBzZXRBdHRyOiBzZXRBdHRyLCByZW1vdmVBdHRyOiByZW1vdmVBdHRyIH07XG5leHBvcnRzLmRlZmF1bHQgPSBleHBvcnRzLmF0dHJpYnV0ZXNBcGk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hdHRyaWJ1dGVzLmpzLm1hcCIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZnVuY3Rpb24gYWRkQ2xhc3MoZWxtLCBuYW1lKSB7XG4gICAgZWxtLmNsYXNzTGlzdC5hZGQobmFtZSk7XG59XG5mdW5jdGlvbiByZW1vdmVDbGFzcyhlbG0sIG5hbWUpIHtcbiAgICBlbG0uY2xhc3NMaXN0LnJlbW92ZShuYW1lKTtcbn1cbmV4cG9ydHMuY2xhc3NBcGkgPSB7IGFkZENsYXNzOiBhZGRDbGFzcywgcmVtb3ZlQ2xhc3M6IHJlbW92ZUNsYXNzIH07XG5leHBvcnRzLmRlZmF1bHQgPSBleHBvcnRzLmNsYXNzQXBpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y2xhc3MuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgQ0FQU19SRUdFWCA9IC9bQS1aXS9nO1xuZnVuY3Rpb24gdG9LZXkoa2V5KSB7XG4gICAgcmV0dXJuIGtleS5yZXBsYWNlKENBUFNfUkVHRVgsICctJCYnKS50b0xvd2VyQ2FzZSgpO1xufVxuZnVuY3Rpb24gbGlzdERhdGFzKGVsbSkge1xuICAgIHZhciBkID0gZWxtLmRhdGFzZXQ7XG4gICAgaWYgKGQpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKGQpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIGtleXMgPSBbXTtcbiAgICAgICAgdmFyIGF0dHJpYnV0ZXMgPSBlbG0uYXR0cmlidXRlcztcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIG4gPSBhdHRyaWJ1dGVzLmxlbmd0aDsgaSA8IG47IGkrKykge1xuICAgICAgICAgICAgdmFyIGtleSA9IGF0dHJpYnV0ZXNbaV0ubm9kZU5hbWU7XG4gICAgICAgICAgICBpZiAoa2V5Lmxlbmd0aCA+IDUgJiYga2V5WzRdID09ICctJyAmJiBrZXlbMF0gPT0gJ2QnICYmIGtleVsxXSA9PSAnYScgJiYga2V5WzJdID09ICd0JyAmJiBrZXlbM10gPT0gJ2EnKSB7XG4gICAgICAgICAgICAgICAga2V5cy5wdXNoKGtleS5zbGljZSg1KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGtleXM7XG4gICAgfVxufVxuZnVuY3Rpb24gZ2V0RGF0YShlbG0sIGtleSkge1xuICAgIHZhciBkID0gZWxtLmRhdGFzZXQ7XG4gICAgcmV0dXJuIChkID8gZFtrZXldIDogZWxtLmdldEF0dHJpYnV0ZShcImRhdGEtXCIgKyBrZXkpKTtcbn1cbmZ1bmN0aW9uIHNldERhdGEoZWxtLCBrZXksIHZhbCkge1xuICAgIHZhciBkID0gZWxtLmRhdGFzZXQ7XG4gICAgaWYgKGQpIHtcbiAgICAgICAgZFtrZXldID0gdmFsO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZWxtLnNldEF0dHJpYnV0ZShcImRhdGEtXCIgKyB0b0tleShrZXkpLCB2YWwpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHJlbW92ZURhdGEoZWxtLCBrZXkpIHtcbiAgICB2YXIgZCA9IGVsbS5kYXRhc2V0O1xuICAgIGlmIChkKSB7XG4gICAgICAgIGlmIChrZXkgaW4gZCkge1xuICAgICAgICAgICAgZGVsZXRlIGRba2V5XTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZWxtLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtXCIgKyB0b0tleShrZXkpKTtcbiAgICB9XG59XG5leHBvcnRzLmRhdGFzZXRBcGkgPSB7IGxpc3REYXRhczogbGlzdERhdGFzLCBnZXREYXRhOiBnZXREYXRhLCBzZXREYXRhOiBzZXREYXRhLCByZW1vdmVEYXRhOiByZW1vdmVEYXRhIH07XG5leHBvcnRzLmRlZmF1bHQgPSBleHBvcnRzLmRhdGFzZXRBcGk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhc2V0LmpzLm1hcCIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZnVuY3Rpb24gaW5zZXJ0Q2hpbGQocGFyZW50Tm9kZSwgbmV3Tm9kZSwgcmVmZXJlbmNlTm9kZSkge1xuICAgIGlmIChyZWZlcmVuY2VOb2RlKSB7XG4gICAgICAgIHBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG5ld05vZGUsIHJlZmVyZW5jZU5vZGUpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcGFyZW50Tm9kZS5hcHBlbmRDaGlsZChuZXdOb2RlKTtcbiAgICB9XG59XG5mdW5jdGlvbiByZW1vdmVDaGlsZChub2RlLCBjaGlsZCkge1xuICAgIG5vZGUucmVtb3ZlQ2hpbGQoY2hpbGQpO1xufVxuZnVuY3Rpb24gcGFyZW50Tm9kZShub2RlKSB7XG4gICAgcmV0dXJuIG5vZGUucGFyZW50Tm9kZTtcbn1cbmZ1bmN0aW9uIGZpcnN0Q2hpbGQobm9kZSkge1xuICAgIHJldHVybiBub2RlLmZpcnN0Q2hpbGQ7XG59XG5mdW5jdGlvbiBuZXh0U2libGluZyhub2RlKSB7XG4gICAgcmV0dXJuIG5vZGUubmV4dFNpYmxpbmc7XG59XG5mdW5jdGlvbiBnZXRTZWxlY3RvcihlbG0pIHtcbiAgICByZXR1cm4gW1xuICAgICAgICBlbG0udGFnTmFtZS50b0xvd2VyQ2FzZSgpLFxuICAgICAgICBlbG0uZ2V0QXR0cmlidXRlKCdpZCcpIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgZWxtLmdldEF0dHJpYnV0ZSgnY2xhc3MnKSB8fCB1bmRlZmluZWQsXG4gICAgXTtcbn1cbmZ1bmN0aW9uIHNldFRleHRDb250ZW50KG5vZGUsIHRleHQpIHtcbiAgICBub2RlLnRleHRDb250ZW50ID0gdGV4dDtcbn1cbmZ1bmN0aW9uIGdldFRleHRDb250ZW50KG5vZGUpIHtcbiAgICByZXR1cm4gbm9kZS50ZXh0Q29udGVudDtcbn1cbmZ1bmN0aW9uIGlzRWxlbWVudChub2RlKSB7XG4gICAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT09IDE7XG59XG5mdW5jdGlvbiBpc1RleHQobm9kZSkge1xuICAgIHJldHVybiBub2RlLm5vZGVUeXBlID09PSAzO1xufVxuZnVuY3Rpb24gaXNDb21tZW50KG5vZGUpIHtcbiAgICByZXR1cm4gbm9kZS5ub2RlVHlwZSA9PT0gODtcbn1cbmZ1bmN0aW9uIGh0bWxEb21BcGkoZG9jdW1lbnQpIHtcbiAgICBmdW5jdGlvbiBjcmVhdGVFbGVtZW50KHRhZywgaWQsIGNscywgbnNVcmkpIHtcbiAgICAgICAgdmFyIGVsbSA9IG5zVXJpID8gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKG5zVXJpLCB0YWcpIDogZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcpO1xuICAgICAgICBpZiAoaWQpXG4gICAgICAgICAgICBlbG0uc2V0QXR0cmlidXRlKCdpZCcsIGlkKTtcbiAgICAgICAgaWYgKGNscylcbiAgICAgICAgICAgIGVsbS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgY2xzKTtcbiAgICAgICAgcmV0dXJuIGVsbTtcbiAgICB9XG4gICAgZnVuY3Rpb24gY3JlYXRlVGV4dE5vZGUodGV4dCkge1xuICAgICAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGV4dCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGNyZWF0ZUNvbW1lbnQodGV4dCkge1xuICAgICAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlQ29tbWVudCh0ZXh0KTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY3JlYXRlRWxlbWVudDogY3JlYXRlRWxlbWVudCxcbiAgICAgICAgY3JlYXRlVGV4dE5vZGU6IGNyZWF0ZVRleHROb2RlLFxuICAgICAgICBjcmVhdGVDb21tZW50OiBjcmVhdGVDb21tZW50LFxuICAgICAgICBpbnNlcnRDaGlsZDogaW5zZXJ0Q2hpbGQsXG4gICAgICAgIHJlbW92ZUNoaWxkOiByZW1vdmVDaGlsZCxcbiAgICAgICAgcGFyZW50Tm9kZTogcGFyZW50Tm9kZSxcbiAgICAgICAgZmlyc3RDaGlsZDogZmlyc3RDaGlsZCxcbiAgICAgICAgbmV4dFNpYmxpbmc6IG5leHRTaWJsaW5nLFxuICAgICAgICBnZXRTZWxlY3RvcjogZ2V0U2VsZWN0b3IsXG4gICAgICAgIHNldFRleHRDb250ZW50OiBzZXRUZXh0Q29udGVudCxcbiAgICAgICAgZ2V0VGV4dENvbnRlbnQ6IGdldFRleHRDb250ZW50LFxuICAgICAgICBpc0VsZW1lbnQ6IGlzRWxlbWVudCxcbiAgICAgICAgaXNUZXh0OiBpc1RleHQsXG4gICAgICAgIGlzQ29tbWVudDogaXNDb21tZW50LFxuICAgIH07XG59XG5leHBvcnRzLmh0bWxEb21BcGkgPSBodG1sRG9tQXBpO1xuZXhwb3J0cy5kZWZhdWx0ID0gaHRtbERvbUFwaTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRvbWFwaS5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmZ1bmN0aW9uIGFkZEV2ZW50KGVsbSwgbmFtZSwgZm4pIHtcbiAgICBlbG0uYWRkRXZlbnRMaXN0ZW5lcihuYW1lLCBmbiwgZmFsc2UpO1xufVxuZnVuY3Rpb24gcmVtb3ZlRXZlbnQoZWxtLCBuYW1lLCBmbikge1xuICAgIGVsbS5yZW1vdmVFdmVudExpc3RlbmVyKG5hbWUsIGZuLCBmYWxzZSk7XG59XG5leHBvcnRzLmV2ZW50TGlzdGVuZXJzQXBpID0geyBhZGRFdmVudDogYWRkRXZlbnQsIHJlbW92ZUV2ZW50OiByZW1vdmVFdmVudCB9O1xuZXhwb3J0cy5kZWZhdWx0ID0gZXhwb3J0cy5ldmVudExpc3RlbmVyc0FwaTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWV2ZW50bGlzdGVuZXJzLmpzLm1hcCIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZnVuY3Rpb24gZ2V0UHJvcChlbG0sIGtleSkge1xuICAgIHJldHVybiBlbG1ba2V5XTtcbn1cbmZ1bmN0aW9uIHNldFByb3AoZWxtLCBrZXksIHZhbCkge1xuICAgIGVsbVtrZXldID0gdmFsO1xufVxuZnVuY3Rpb24gcmVtb3ZlUHJvcChlbG0sIGtleSkge1xuICAgIGRlbGV0ZSBlbG1ba2V5XTtcbn1cbmV4cG9ydHMucHJvcHNBcGkgPSB7IGdldFByb3A6IGdldFByb3AsIHNldFByb3A6IHNldFByb3AsIHJlbW92ZVByb3A6IHJlbW92ZVByb3AgfTtcbmV4cG9ydHMuZGVmYXVsdCA9IGV4cG9ydHMucHJvcHNBcGk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wcm9wcy5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciByYWYgPSAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSkgfHwgc2V0VGltZW91dDtcbmZ1bmN0aW9uIG5leHRGcmFtZShmbikge1xuICAgIHJhZihmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJhZihmbik7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBsaXN0U3R5bGUoZWxtKSB7XG4gICAgdmFyIHN0eWxlID0gZWxtLnN0eWxlO1xuICAgIHZhciBrZXlzID0gW107XG4gICAgZm9yICh2YXIga2V5IGluIHN0eWxlKSB7XG4gICAgICAgIGlmIChzdHlsZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICBrZXlzLnB1c2goa2V5KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ga2V5cztcbn1cbmZ1bmN0aW9uIGdldFN0eWxlKGVsbSwgbmFtZSkge1xuICAgIHJldHVybiBlbG0uc3R5bGVbbmFtZV07XG59XG5mdW5jdGlvbiBzZXRTdHlsZShlbG0sIG5hbWUsIHZhbCwgbmV4dCkge1xuICAgIGlmIChuZXh0ID09PSB2b2lkIDApIHsgbmV4dCA9IGZhbHNlOyB9XG4gICAgdmFyIGZuID0gbmFtZVswXSA9PT0gJy0nICYmIG5hbWVbMV0gPT09ICctJyA/XG4gICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGVsbS5zdHlsZS5zZXRQcm9wZXJ0eShuYW1lLCB2YWwpO1xuICAgICAgICB9IDogZnVuY3Rpb24gKCkge1xuICAgICAgICBlbG0uc3R5bGVbbmFtZV0gPSB2YWw7XG4gICAgfTtcbiAgICBpZiAoIW5leHQpIHtcbiAgICAgICAgZm4oKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIG5leHRGcmFtZShmbik7XG4gICAgfVxufVxuZnVuY3Rpb24gcmVtb3ZlU3R5bGUoZWxtLCBuYW1lKSB7XG4gICAgaWYgKG5hbWVbMF0gPT0gJy0nICYmIG5hbWVbMV0gPT0gJy0nKSB7XG4gICAgICAgIGVsbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eShuYW1lKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGVsbS5zdHlsZVtuYW1lXSA9ICcnO1xuICAgIH1cbn1cbmZ1bmN0aW9uIG9uVHJhbnNFbmQoZWxtLCBuYW1lcywgY2FsbGJhY2spIHtcbiAgICB2YXIgY29tcFN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShlbG0pO1xuICAgIHZhciBwcm9wcyA9IGNvbXBTdHlsZVsndHJhbnNpdGlvbi1wcm9wZXJ0eSddLnNwbGl0KCcsICcpO1xuICAgIHZhciBhbW91bnQgPSAwO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgaWYgKG5hbWVzLmluZGV4T2YocHJvcHNbaV0pICE9PSAtMSlcbiAgICAgICAgICAgIGFtb3VudCsrO1xuICAgIH1cbiAgICBlbG0uYWRkRXZlbnRMaXN0ZW5lcigndHJhbnNpdGlvbmVuZCcsIGZ1bmN0aW9uIChldikge1xuICAgICAgICBpZiAoZXYudGFyZ2V0ID09PSBlbG0pXG4gICAgICAgICAgICAtLWFtb3VudDtcbiAgICAgICAgaWYgKGFtb3VudCA9PT0gMClcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgfSk7XG59XG5leHBvcnRzLnN0eWxlQXBpID0geyBsaXN0U3R5bGU6IGxpc3RTdHlsZSwgZ2V0U3R5bGU6IGdldFN0eWxlLCBzZXRTdHlsZTogc2V0U3R5bGUsIHJlbW92ZVN0eWxlOiByZW1vdmVTdHlsZSwgb25UcmFuc0VuZDogb25UcmFuc0VuZCB9O1xuZXhwb3J0cy5kZWZhdWx0ID0gZXhwb3J0cy5zdHlsZUFwaTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0eWxlLmpzLm1hcCIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZub2RlXzEgPSByZXF1aXJlKFwiLi92bm9kZVwiKTtcbnZhciBzbmFiYmRvbV8xID0gcmVxdWlyZShcIi4vc25hYmJkb21cIik7XG5mdW5jdGlvbiBhZGROUyhkYXRhLCBjaGlsZHJlbiwgc2VsKSB7XG4gICAgZGF0YS5ucyA9ICdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc7XG4gICAgaWYgKHNlbCAhPT0gJ2ZvcmVpZ25PYmplY3QnICYmIHNuYWJiZG9tXzEuaXNEZWYoY2hpbGRyZW4pKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBjaGlsZERhdGEgPSBjaGlsZHJlbltpXS5kYXRhO1xuICAgICAgICAgICAgaWYgKHNuYWJiZG9tXzEuaXNEZWYoY2hpbGREYXRhKSkge1xuICAgICAgICAgICAgICAgIGFkZE5TKGNoaWxkRGF0YSwgY2hpbGRyZW5baV0uY2hpbGRyZW4sIGNoaWxkcmVuW2ldLnNlbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBoKHNlbCwgYiwgYykge1xuICAgIHZhciBkYXRhID0ge30sIGNoaWxkcmVuLCB0ZXh0LCBpO1xuICAgIGlmIChzbmFiYmRvbV8xLmlzRGVmKGMpKSB7XG4gICAgICAgIGRhdGEgPSBiO1xuICAgICAgICBpZiAoc25hYmJkb21fMS5pc0FycmF5KGMpKSB7XG4gICAgICAgICAgICBjaGlsZHJlbiA9IGM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc25hYmJkb21fMS5pc1ByaW1pdGl2ZShjKSkge1xuICAgICAgICAgICAgdGV4dCA9IGM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYyAmJiBjLnNlbCkge1xuICAgICAgICAgICAgY2hpbGRyZW4gPSBbY107XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoc25hYmJkb21fMS5pc0RlZihiKSkge1xuICAgICAgICBpZiAoc25hYmJkb21fMS5pc0FycmF5KGIpKSB7XG4gICAgICAgICAgICBjaGlsZHJlbiA9IGI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc25hYmJkb21fMS5pc1ByaW1pdGl2ZShiKSkge1xuICAgICAgICAgICAgdGV4dCA9IGI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYiAmJiBiLnNlbCkge1xuICAgICAgICAgICAgY2hpbGRyZW4gPSBbYl07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkYXRhID0gYjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoc25hYmJkb21fMS5pc0FycmF5KGNoaWxkcmVuKSkge1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIGlmIChzbmFiYmRvbV8xLmlzUHJpbWl0aXZlKGNoaWxkcmVuW2ldKSlcbiAgICAgICAgICAgICAgICBjaGlsZHJlbltpXSA9IHZub2RlXzEudm5vZGUodW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgY2hpbGRyZW5baV0sIHVuZGVmaW5lZCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHNlbFswXSA9PT0gJ3MnICYmIHNlbFsxXSA9PT0gJ3YnICYmIHNlbFsyXSA9PT0gJ2cnICYmXG4gICAgICAgIChzZWwubGVuZ3RoID09PSAzIHx8IHNlbFszXSA9PT0gJy4nIHx8IHNlbFszXSA9PT0gJyMnKSkge1xuICAgICAgICBhZGROUyhkYXRhLCBjaGlsZHJlbiwgc2VsKTtcbiAgICB9XG4gICAgcmV0dXJuIHZub2RlXzEudm5vZGUoc2VsLCBkYXRhLCBjaGlsZHJlbiwgdGV4dCwgdW5kZWZpbmVkKTtcbn1cbmV4cG9ydHMuaCA9IGg7XG47XG5leHBvcnRzLmRlZmF1bHQgPSBoO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aC5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmZ1bmN0aW9uIGF0dHJpYnV0ZXNNb2R1bGUoYXBpKSB7XG4gICAgZnVuY3Rpb24gcmVhZEF0dHJzKHZub2RlKSB7XG4gICAgICAgIHZhciBlbG0gPSB2bm9kZS5lbG0sIGtleXMgPSBhcGkubGlzdEF0dHJzKGVsbSksIGF0dHJzID0ge307XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwga2V5c18xID0ga2V5czsgX2kgPCBrZXlzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIga2V5ID0ga2V5c18xW19pXTtcbiAgICAgICAgICAgIGlmIChrZXkgIT0gJ2lkJyAmJiBrZXkgIT0gJ2NsYXNzJyAmJlxuICAgICAgICAgICAgICAgICEoa2V5Lmxlbmd0aCA+IDUgJiYga2V5WzRdID09ICctJyAmJiBrZXlbMF0gPT0gJ2QnICYmIGtleVsxXSA9PSAnYScgJiYga2V5WzJdID09ICd0JyAmJiBrZXlbM10gPT0gJ2EnKSkge1xuICAgICAgICAgICAgICAgIGF0dHJzW2tleV0gPSBhcGkuZ2V0QXR0cihlbG0sIGtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdm5vZGUuZGF0YS5hdHRycyA9IGF0dHJzO1xuICAgIH1cbiAgICBmdW5jdGlvbiB1cGRhdGVBdHRycyhvbGRWbm9kZSwgdm5vZGUpIHtcbiAgICAgICAgdmFyIGVsbSA9IHZub2RlLmVsbTtcbiAgICAgICAgdmFyIGtleSwgb2xkQXR0cnMgPSBvbGRWbm9kZS5kYXRhLmF0dHJzLCBhdHRycyA9IHZub2RlLmRhdGEuYXR0cnM7XG4gICAgICAgIGlmICghb2xkQXR0cnMgJiYgIWF0dHJzKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAob2xkQXR0cnMgPT09IGF0dHJzKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBvbGRBdHRycyA9IG9sZEF0dHJzIHx8IHt9O1xuICAgICAgICBhdHRycyA9IGF0dHJzIHx8IHt9O1xuICAgICAgICAvLyB1cGRhdGUgbW9kaWZpZWQgYXR0cmlidXRlcywgYWRkIG5ldyBhdHRyaWJ1dGVzXG4gICAgICAgIGZvciAoa2V5IGluIGF0dHJzKSB7XG4gICAgICAgICAgICB2YXIgY3VyID0gYXR0cnNba2V5XTtcbiAgICAgICAgICAgIHZhciBvbGQgPSBvbGRBdHRyc1trZXldO1xuICAgICAgICAgICAgaWYgKG9sZCAhPT0gY3VyKSB7XG4gICAgICAgICAgICAgICAgYXBpLnNldEF0dHIoZWxtLCBrZXksIGN1cik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gcmVtb3ZlIHJlbW92ZWQgYXR0cmlidXRlc1xuICAgICAgICAvLyB1c2UgYGluYCBvcGVyYXRvciBzaW5jZSB0aGUgcHJldmlvdXMgYGZvcmAgaXRlcmF0aW9uIHVzZXMgaXQgKC5pLmUuIGFkZCBldmVuIGF0dHJpYnV0ZXMgd2l0aCB1bmRlZmluZWQgdmFsdWUpXG4gICAgICAgIC8vIHRoZSBvdGhlciBvcHRpb24gaXMgdG8gcmVtb3ZlIGFsbCBhdHRyaWJ1dGVzIHdpdGggdmFsdWUgPT0gdW5kZWZpbmVkXG4gICAgICAgIGZvciAoa2V5IGluIG9sZEF0dHJzKSB7XG4gICAgICAgICAgICBpZiAoIShrZXkgaW4gYXR0cnMpKSB7XG4gICAgICAgICAgICAgICAgYXBpLnJlbW92ZUF0dHIoZWxtLCBrZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7IHJlYWQ6IHJlYWRBdHRycywgY3JlYXRlOiB1cGRhdGVBdHRycywgdXBkYXRlOiB1cGRhdGVBdHRycyB9O1xufVxuZXhwb3J0cy5hdHRyaWJ1dGVzTW9kdWxlID0gYXR0cmlidXRlc01vZHVsZTtcbmV4cG9ydHMuZGVmYXVsdCA9IGF0dHJpYnV0ZXNNb2R1bGU7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hdHRyaWJ1dGVzLmpzLm1hcCIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZnVuY3Rpb24gY2xhc3NNb2R1bGUoYXBpKSB7XG4gICAgZnVuY3Rpb24gdXBkYXRlQ2xhc3Mob2xkVm5vZGUsIHZub2RlKSB7XG4gICAgICAgIHZhciBlbG0gPSB2bm9kZS5lbG07XG4gICAgICAgIHZhciBjdXIsIG5hbWUsIG9sZENsYXNzID0gb2xkVm5vZGUuZGF0YS5jbGFzcywgbmV3Q2xhc3MgPSB2bm9kZS5kYXRhLmNsYXNzO1xuICAgICAgICBpZiAoIW9sZENsYXNzICYmICFuZXdDbGFzcylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaWYgKG9sZENsYXNzID09PSBuZXdDbGFzcylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgb2xkQ2xhc3MgPSBvbGRDbGFzcyB8fCB7fTtcbiAgICAgICAgbmV3Q2xhc3MgPSBuZXdDbGFzcyB8fCB7fTtcbiAgICAgICAgZm9yIChuYW1lIGluIG9sZENsYXNzKSB7XG4gICAgICAgICAgICBpZiAoIW5ld0NsYXNzW25hbWVdKSB7XG4gICAgICAgICAgICAgICAgYXBpLnJlbW92ZUNsYXNzKGVsbSwgbmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChuYW1lIGluIG5ld0NsYXNzKSB7XG4gICAgICAgICAgICBjdXIgPSBuZXdDbGFzc1tuYW1lXTtcbiAgICAgICAgICAgIGlmIChjdXIgIT09IG9sZENsYXNzW25hbWVdKSB7XG4gICAgICAgICAgICAgICAgYXBpW2N1ciA/ICdhZGRDbGFzcycgOiAncmVtb3ZlQ2xhc3MnXShlbG0sIG5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7IGNyZWF0ZTogdXBkYXRlQ2xhc3MsIHVwZGF0ZTogdXBkYXRlQ2xhc3MgfTtcbn1cbmV4cG9ydHMuY2xhc3NNb2R1bGUgPSBjbGFzc01vZHVsZTtcbmV4cG9ydHMuZGVmYXVsdCA9IGNsYXNzTW9kdWxlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y2xhc3MuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5mdW5jdGlvbiBkYXRhc2V0TW9kdWxlKGFwaSkge1xuICAgIGZ1bmN0aW9uIHJlYWREYXRhc2V0KHZub2RlKSB7XG4gICAgICAgIHZhciBlbG0gPSB2bm9kZS5lbG0sIGtleXMgPSBhcGkubGlzdERhdGFzKGVsbSksIGRhdGFzID0ge307XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwga2V5c18xID0ga2V5czsgX2kgPCBrZXlzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIga2V5ID0ga2V5c18xW19pXTtcbiAgICAgICAgICAgIGRhdGFzW2tleV0gPSBhcGkuZ2V0RGF0YShlbG0sIGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgdm5vZGUuZGF0YS5kYXRhc2V0ID0gZGF0YXM7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHVwZGF0ZURhdGFzZXQob2xkVm5vZGUsIHZub2RlKSB7XG4gICAgICAgIHZhciBlbG0gPSB2bm9kZS5lbG0sIG9sZERhdGFzZXQgPSBvbGRWbm9kZS5kYXRhLmRhdGFzZXQsIGRhdGFzZXQgPSB2bm9kZS5kYXRhLmRhdGFzZXQsIGtleTtcbiAgICAgICAgaWYgKCFvbGREYXRhc2V0ICYmICFkYXRhc2V0KVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAob2xkRGF0YXNldCA9PT0gZGF0YXNldClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgb2xkRGF0YXNldCA9IG9sZERhdGFzZXQgfHwge307XG4gICAgICAgIGRhdGFzZXQgPSBkYXRhc2V0IHx8IHt9O1xuICAgICAgICBmb3IgKGtleSBpbiBvbGREYXRhc2V0KSB7XG4gICAgICAgICAgICBpZiAoIWRhdGFzZXRba2V5XSkge1xuICAgICAgICAgICAgICAgIGFwaS5yZW1vdmVEYXRhKGVsbSwga2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGtleSBpbiBkYXRhc2V0KSB7XG4gICAgICAgICAgICBpZiAob2xkRGF0YXNldFtrZXldICE9PSBkYXRhc2V0W2tleV0pIHtcbiAgICAgICAgICAgICAgICBhcGkuc2V0RGF0YShlbG0sIGtleSwgZGF0YXNldFtrZXldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4geyByZWFkOiByZWFkRGF0YXNldCwgY3JlYXRlOiB1cGRhdGVEYXRhc2V0LCB1cGRhdGU6IHVwZGF0ZURhdGFzZXQgfTtcbn1cbmV4cG9ydHMuZGF0YXNldE1vZHVsZSA9IGRhdGFzZXRNb2R1bGU7XG5leHBvcnRzLmRlZmF1bHQgPSBkYXRhc2V0TW9kdWxlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YXNldC5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmZ1bmN0aW9uIGludm9rZUhhbmRsZXIoaGFuZGxlciwgdm5vZGUsIGV2ZW50KSB7XG4gICAgaWYgKHR5cGVvZiBoYW5kbGVyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgLy8gY2FsbCBmdW5jdGlvbiBoYW5kbGVyXG4gICAgICAgIGhhbmRsZXIuY2FsbCh2bm9kZSwgZXZlbnQsIHZub2RlKTtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIGhhbmRsZXIgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgLy8gY2FsbCBoYW5kbGVyIHdpdGggYXJndW1lbnRzXG4gICAgICAgIGlmICh0eXBlb2YgaGFuZGxlclswXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAvLyBzcGVjaWFsIGNhc2UgZm9yIHNpbmdsZSBhcmd1bWVudCBmb3IgcGVyZm9ybWFuY2VcbiAgICAgICAgICAgIGlmIChoYW5kbGVyLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgIGhhbmRsZXJbMF0uY2FsbCh2bm9kZSwgaGFuZGxlclsxXSwgZXZlbnQsIHZub2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBhcmdzID0gaGFuZGxlci5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICBhcmdzLnB1c2goZXZlbnQpO1xuICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh2bm9kZSk7XG4gICAgICAgICAgICAgICAgaGFuZGxlclswXS5hcHBseSh2bm9kZSwgYXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBjYWxsIG11bHRpcGxlIGhhbmRsZXJzXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhhbmRsZXIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpbnZva2VIYW5kbGVyKGhhbmRsZXJbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gaGFuZGxlRXZlbnQoZXZlbnQsIHZub2RlKSB7XG4gICAgdmFyIG5hbWUgPSBldmVudC50eXBlLCBvbiA9IHZub2RlLmRhdGEub247XG4gICAgLy8gY2FsbCBldmVudCBoYW5kbGVyKHMpIGlmIGV4aXN0c1xuICAgIGlmIChvbiAmJiBvbltuYW1lXSkge1xuICAgICAgICBpbnZva2VIYW5kbGVyKG9uW25hbWVdLCB2bm9kZSwgZXZlbnQpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNyZWF0ZUxpc3RlbmVyKCkge1xuICAgIHJldHVybiBmdW5jdGlvbiBoYW5kbGVyKGV2ZW50KSB7XG4gICAgICAgIGhhbmRsZUV2ZW50KGV2ZW50LCBoYW5kbGVyLnZub2RlKTtcbiAgICB9O1xufVxuZnVuY3Rpb24gZXZlbnRMaXN0ZW5lcnNNb2R1bGUoYXBpKSB7XG4gICAgZnVuY3Rpb24gdXBkYXRlRXZlbnRMaXN0ZW5lcnMob2xkVm5vZGUsIHZub2RlKSB7XG4gICAgICAgIHZhciBvbGRPbiA9IG9sZFZub2RlLmRhdGEub24sIG9sZExpc3RlbmVyID0gb2xkVm5vZGUubGlzdGVuZXIsIG9sZEVsbSA9IG9sZFZub2RlLmVsbSwgb24gPSB2bm9kZSAmJiB2bm9kZS5kYXRhLm9uLCBlbG0gPSAodm5vZGUgJiYgdm5vZGUuZWxtKTtcbiAgICAgICAgdmFyIG5hbWU7XG4gICAgICAgIC8vIG9wdGltaXphdGlvbiBmb3IgcmV1c2VkIGltbXV0YWJsZSBoYW5kbGVyc1xuICAgICAgICBpZiAob2xkT24gPT09IG9uKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gcmVtb3ZlIGV4aXN0aW5nIGxpc3RlbmVycyB3aGljaCBubyBsb25nZXIgdXNlZFxuICAgICAgICBpZiAob2xkT24gJiYgb2xkTGlzdGVuZXIpIHtcbiAgICAgICAgICAgIC8vIGlmIGVsZW1lbnQgY2hhbmdlZCBvciBkZWxldGVkIHdlIHJlbW92ZSBhbGwgZXhpc3RpbmcgbGlzdGVuZXJzIHVuY29uZGl0aW9uYWxseVxuICAgICAgICAgICAgaWYgKCFvbikge1xuICAgICAgICAgICAgICAgIGZvciAobmFtZSBpbiBvbGRPbikge1xuICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgbGlzdGVuZXIgaWYgZWxlbWVudCB3YXMgY2hhbmdlZCBvciBleGlzdGluZyBsaXN0ZW5lcnMgcmVtb3ZlZFxuICAgICAgICAgICAgICAgICAgICBhcGkucmVtb3ZlRXZlbnQob2xkRWxtLCBuYW1lLCBvbGRMaXN0ZW5lcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9yIChuYW1lIGluIG9sZE9uKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBsaXN0ZW5lciBpZiBleGlzdGluZyBsaXN0ZW5lciByZW1vdmVkXG4gICAgICAgICAgICAgICAgICAgIGlmICghb25bbmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwaS5yZW1vdmVFdmVudChvbGRFbG0sIG5hbWUsIG9sZExpc3RlbmVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBhZGQgbmV3IGxpc3RlbmVycyB3aGljaCBoYXMgbm90IGFscmVhZHkgYXR0YWNoZWRcbiAgICAgICAgaWYgKG9uKSB7XG4gICAgICAgICAgICAvLyByZXVzZSBleGlzdGluZyBsaXN0ZW5lciBvciBjcmVhdGUgbmV3XG4gICAgICAgICAgICB2YXIgbGlzdGVuZXIgPSB2bm9kZS5saXN0ZW5lciA9IG9sZFZub2RlLmxpc3RlbmVyIHx8IGNyZWF0ZUxpc3RlbmVyKCk7XG4gICAgICAgICAgICAvLyB1cGRhdGUgdm5vZGUgZm9yIGxpc3RlbmVyXG4gICAgICAgICAgICBsaXN0ZW5lci52bm9kZSA9IHZub2RlO1xuICAgICAgICAgICAgLy8gaWYgZWxlbWVudCBjaGFuZ2VkIG9yIGFkZGVkIHdlIGFkZCBhbGwgbmVlZGVkIGxpc3RlbmVycyB1bmNvbmRpdGlvbmFsbHlcbiAgICAgICAgICAgIGlmICghb2xkT24pIHtcbiAgICAgICAgICAgICAgICBmb3IgKG5hbWUgaW4gb24pIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIGxpc3RlbmVyIGlmIGVsZW1lbnQgd2FzIGNoYW5nZWQgb3IgbmV3IGxpc3RlbmVycyBhZGRlZFxuICAgICAgICAgICAgICAgICAgICBhcGkuYWRkRXZlbnQoZWxtLCBuYW1lLCBsaXN0ZW5lcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9yIChuYW1lIGluIG9uKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFkZCBsaXN0ZW5lciBpZiBuZXcgbGlzdGVuZXIgYWRkZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFvbGRPbltuYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXBpLmFkZEV2ZW50KGVsbSwgbmFtZSwgbGlzdGVuZXIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGNyZWF0ZTogdXBkYXRlRXZlbnRMaXN0ZW5lcnMsXG4gICAgICAgIHVwZGF0ZTogdXBkYXRlRXZlbnRMaXN0ZW5lcnMsXG4gICAgICAgIGRlc3Ryb3k6IHVwZGF0ZUV2ZW50TGlzdGVuZXJzXG4gICAgfTtcbn1cbmV4cG9ydHMuZXZlbnRMaXN0ZW5lcnNNb2R1bGUgPSBldmVudExpc3RlbmVyc01vZHVsZTtcbmV4cG9ydHMuZGVmYXVsdCA9IGV2ZW50TGlzdGVuZXJzTW9kdWxlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZXZlbnRsaXN0ZW5lcnMuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5mdW5jdGlvbiBwcm9wc01vZHVsZShhcGkpIHtcbiAgICBmdW5jdGlvbiB1cGRhdGVQcm9wcyhvbGRWbm9kZSwgdm5vZGUpIHtcbiAgICAgICAgdmFyIGVsbSA9IHZub2RlLmVsbTtcbiAgICAgICAgdmFyIGtleSwgY3VyLCBvbGQsIG9sZFByb3BzID0gb2xkVm5vZGUuZGF0YS5wcm9wcywgcHJvcHMgPSB2bm9kZS5kYXRhLnByb3BzO1xuICAgICAgICBpZiAoIW9sZFByb3BzICYmICFwcm9wcylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaWYgKG9sZFByb3BzID09PSBwcm9wcylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgb2xkUHJvcHMgPSBvbGRQcm9wcyB8fCB7fTtcbiAgICAgICAgcHJvcHMgPSBwcm9wcyB8fCB7fTtcbiAgICAgICAgZm9yIChrZXkgaW4gb2xkUHJvcHMpIHtcbiAgICAgICAgICAgIGlmICghcHJvcHNba2V5XSkge1xuICAgICAgICAgICAgICAgIGFwaS5yZW1vdmVQcm9wKGVsbSwga2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGtleSBpbiBwcm9wcykge1xuICAgICAgICAgICAgY3VyID0gcHJvcHNba2V5XTtcbiAgICAgICAgICAgIG9sZCA9IG9sZFByb3BzW2tleV07XG4gICAgICAgICAgICBpZiAob2xkICE9PSBjdXIgJiYgKGtleSAhPT0gJ3ZhbHVlJyB8fCBhcGkuZ2V0UHJvcChlbG0sIGtleSkgIT09IGN1cikpIHtcbiAgICAgICAgICAgICAgICBhcGkuc2V0UHJvcChlbG0sIGtleSwgY3VyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4geyBjcmVhdGU6IHVwZGF0ZVByb3BzLCB1cGRhdGU6IHVwZGF0ZVByb3BzIH07XG59XG5leHBvcnRzLnByb3BzTW9kdWxlID0gcHJvcHNNb2R1bGU7XG5leHBvcnRzLmRlZmF1bHQgPSBwcm9wc01vZHVsZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXByb3BzLmpzLm1hcCIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZnVuY3Rpb24gc3R5bGVNb2R1bGUoYXBpKSB7XG4gICAgZnVuY3Rpb24gcmVhZFN0eWxlKHZub2RlKSB7XG4gICAgICAgIHZhciBlbG0gPSB2bm9kZS5lbG07XG4gICAgICAgIHZhciBrZXlzID0gYXBpLmxpc3RTdHlsZShlbG0pO1xuICAgICAgICB2YXIgc3R5bGUgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBrZXlzXzEgPSBrZXlzOyBfaSA8IGtleXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSBrZXlzXzFbX2ldO1xuICAgICAgICAgICAgc3R5bGVba2V5XSA9IGFwaS5nZXRTdHlsZShlbG0sIGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgdm5vZGUuZGF0YS5zdHlsZSA9IHN0eWxlO1xuICAgIH1cbiAgICBmdW5jdGlvbiB1cGRhdGVTdHlsZShvbGRWbm9kZSwgdm5vZGUpIHtcbiAgICAgICAgdmFyIGVsbSA9IHZub2RlLmVsbTtcbiAgICAgICAgdmFyIGN1ciwgbmFtZSwgb2xkU3R5bGUgPSBvbGRWbm9kZS5kYXRhLnN0eWxlLCBzdHlsZSA9IHZub2RlLmRhdGEuc3R5bGU7XG4gICAgICAgIGlmICghb2xkU3R5bGUgJiYgIXN0eWxlKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAob2xkU3R5bGUgPT09IHN0eWxlKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBvbGRTdHlsZSA9IG9sZFN0eWxlIHx8IHt9O1xuICAgICAgICBzdHlsZSA9IHN0eWxlIHx8IHt9O1xuICAgICAgICB2YXIgb2xkSGFzRGVsID0gJ2RlbGF5ZWQnIGluIG9sZFN0eWxlO1xuICAgICAgICBmb3IgKG5hbWUgaW4gb2xkU3R5bGUpIHtcbiAgICAgICAgICAgIGlmICghc3R5bGVbbmFtZV0pIHtcbiAgICAgICAgICAgICAgICBhcGkucmVtb3ZlU3R5bGUoZWxtLCBuYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKG5hbWUgaW4gc3R5bGUpIHtcbiAgICAgICAgICAgIGN1ciA9IHN0eWxlW25hbWVdO1xuICAgICAgICAgICAgaWYgKG5hbWUgPT09ICdkZWxheWVkJyAmJiBzdHlsZS5kZWxheWVkKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgbmFtZTIgaW4gc3R5bGUuZGVsYXllZCkge1xuICAgICAgICAgICAgICAgICAgICBjdXIgPSBzdHlsZS5kZWxheWVkW25hbWUyXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFvbGRIYXNEZWwgfHwgY3VyICE9PSBvbGRTdHlsZS5kZWxheWVkW25hbWUyXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXBpLnNldFN0eWxlKGVsbSwgbmFtZTIsIGN1ciwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChuYW1lICE9PSAncmVtb3ZlJyAmJiBjdXIgIT09IG9sZFN0eWxlW25hbWVdKSB7XG4gICAgICAgICAgICAgICAgYXBpLnNldFN0eWxlKGVsbSwgbmFtZSwgY3VyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBhcHBseURlc3Ryb3lTdHlsZSh2bm9kZSkge1xuICAgICAgICB2YXIgZWxtID0gdm5vZGUuZWxtLCBzID0gdm5vZGUuZGF0YS5zdHlsZTtcbiAgICAgICAgdmFyIHN0eWxlLCBuYW1lO1xuICAgICAgICBpZiAoIXMgfHwgIShzdHlsZSA9IHMuZGVzdHJveSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGZvciAobmFtZSBpbiBzdHlsZSkge1xuICAgICAgICAgICAgYXBpLnNldFN0eWxlKGVsbSwgbmFtZSwgc3R5bGVbbmFtZV0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIGFwcGx5UmVtb3ZlU3R5bGUodm5vZGUsIHJtKSB7XG4gICAgICAgIHZhciBzID0gdm5vZGUuZGF0YS5zdHlsZTtcbiAgICAgICAgaWYgKCFzIHx8ICFzLnJlbW92ZSkge1xuICAgICAgICAgICAgcm0oKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZWxtID0gdm5vZGUuZWxtLCBzdHlsZSA9IHMucmVtb3ZlLCBhcHBsaWVkID0gW107XG4gICAgICAgIHZhciBuYW1lO1xuICAgICAgICBmb3IgKG5hbWUgaW4gc3R5bGUpIHtcbiAgICAgICAgICAgIGFwcGxpZWQucHVzaChuYW1lKTtcbiAgICAgICAgICAgIGFwaS5zZXRTdHlsZShlbG0sIG5hbWUsIHN0eWxlW25hbWVdKTtcbiAgICAgICAgfVxuICAgICAgICBhcGkub25UcmFuc0VuZChlbG0sIGFwcGxpZWQsIHJtKTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVhZDogcmVhZFN0eWxlLFxuICAgICAgICBjcmVhdGU6IHVwZGF0ZVN0eWxlLFxuICAgICAgICB1cGRhdGU6IHVwZGF0ZVN0eWxlLFxuICAgICAgICBkZXN0cm95OiBhcHBseURlc3Ryb3lTdHlsZSxcbiAgICAgICAgcmVtb3ZlOiBhcHBseVJlbW92ZVN0eWxlXG4gICAgfTtcbn1cbmV4cG9ydHMuc3R5bGVNb2R1bGUgPSBzdHlsZU1vZHVsZTtcbmV4cG9ydHMuZGVmYXVsdCA9IHN0eWxlTW9kdWxlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3R5bGUuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgc25hYmJkb21fMSA9IHJlcXVpcmUoXCIuL3NuYWJiZG9tXCIpO1xudmFyIGF0dHJpYnV0ZXNfMSA9IHJlcXVpcmUoXCIuL21vZHVsZXMvYXR0cmlidXRlc1wiKTsgLy8gZm9yIHNldHRpbmcgYXR0cmlidXRlcyBvbiBET00gZWxlbWVudHNcbnZhciBjbGFzc18xID0gcmVxdWlyZShcIi4vbW9kdWxlcy9jbGFzc1wiKTsgLy8gbWFrZXMgaXQgZWFzeSB0byB0b2dnbGUgY2xhc3Nlc1xudmFyIHByb3BzXzEgPSByZXF1aXJlKFwiLi9tb2R1bGVzL3Byb3BzXCIpOyAvLyBmb3Igc2V0dGluZyBwcm9wZXJ0aWVzIG9uIERPTSBlbGVtZW50c1xudmFyIHN0eWxlXzEgPSByZXF1aXJlKFwiLi9tb2R1bGVzL3N0eWxlXCIpOyAvLyBoYW5kbGVzIHN0eWxpbmcgb24gZWxlbWVudHMgd2l0aCBzdXBwb3J0IGZvciBhbmltYXRpb25zXG52YXIgZXZlbnRsaXN0ZW5lcnNfMSA9IHJlcXVpcmUoXCIuL21vZHVsZXMvZXZlbnRsaXN0ZW5lcnNcIik7IC8vIGF0dGFjaGVzIGV2ZW50IGxpc3RlbmVyc1xudmFyIGRhdGFzZXRfMSA9IHJlcXVpcmUoXCIuL21vZHVsZXMvZGF0YXNldFwiKTsgLy8gaGFuZGxlcyBkYXRhc2V0XG52YXIgZG9tYXBpXzEgPSByZXF1aXJlKFwiLi9jbGllbnQvZG9tYXBpXCIpOyAvLyBicm93c2VyIERPTSBBUElcbnZhciBhdHRyaWJ1dGVzXzIgPSByZXF1aXJlKFwiLi9jbGllbnQvYXR0cmlidXRlc1wiKTtcbnZhciBjbGFzc18yID0gcmVxdWlyZShcIi4vY2xpZW50L2NsYXNzXCIpO1xudmFyIHByb3BzXzIgPSByZXF1aXJlKFwiLi9jbGllbnQvcHJvcHNcIik7XG52YXIgc3R5bGVfMiA9IHJlcXVpcmUoXCIuL2NsaWVudC9zdHlsZVwiKTtcbnZhciBldmVudGxpc3RlbmVyc18yID0gcmVxdWlyZShcIi4vY2xpZW50L2V2ZW50bGlzdGVuZXJzXCIpO1xudmFyIGRhdGFzZXRfMiA9IHJlcXVpcmUoXCIuL2NsaWVudC9kYXRhc2V0XCIpO1xudmFyIGhfMSA9IHJlcXVpcmUoXCIuL2hcIik7IC8vIGhlbHBlciBmdW5jdGlvbiBmb3IgY3JlYXRpbmcgdm5vZGVzXG5leHBvcnRzLnNuYWJiZG9tTW9kdWxlcyA9IFtcbiAgICBhdHRyaWJ1dGVzXzEuYXR0cmlidXRlc01vZHVsZShhdHRyaWJ1dGVzXzIuYXR0cmlidXRlc0FwaSksXG4gICAgY2xhc3NfMS5jbGFzc01vZHVsZShjbGFzc18yLmNsYXNzQXBpKSxcbiAgICBwcm9wc18xLnByb3BzTW9kdWxlKHByb3BzXzIucHJvcHNBcGkpLFxuICAgIHN0eWxlXzEuc3R5bGVNb2R1bGUoc3R5bGVfMi5zdHlsZUFwaSksXG4gICAgZXZlbnRsaXN0ZW5lcnNfMS5ldmVudExpc3RlbmVyc01vZHVsZShldmVudGxpc3RlbmVyc18yLmV2ZW50TGlzdGVuZXJzQXBpKSxcbiAgICBkYXRhc2V0XzEuZGF0YXNldE1vZHVsZShkYXRhc2V0XzIuZGF0YXNldEFwaSksXG5dO1xuLy8gSW5pdCBwYXRjaCBmdW5jdGlvbiB3aXRoIGNob29zZW4gbW9kdWxlc1xudmFyIF9hID0gc25hYmJkb21fMS5pbml0KGV4cG9ydHMuc25hYmJkb21Nb2R1bGVzLCBkb21hcGlfMS5odG1sRG9tQXBpKGRvY3VtZW50KSksIHJlYWQgPSBfYS5yZWFkLCBwYXRjaCA9IF9hLnBhdGNoO1xuZXhwb3J0cy5zbmFiYmRvbUJ1bmRsZSA9IHsgcmVhZDogcmVhZCwgcGF0Y2g6IHBhdGNoLCBoOiBoXzEuaCB9O1xuZXhwb3J0cy5kZWZhdWx0ID0gZXhwb3J0cy5zbmFiYmRvbUJ1bmRsZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNuYWJiZG9tLmJ1bmRsZS5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2bm9kZV8xID0gcmVxdWlyZShcIi4vdm5vZGVcIik7XG5leHBvcnRzLmlzQXJyYXkgPSBBcnJheS5pc0FycmF5O1xuZnVuY3Rpb24gaXNQcmltaXRpdmUocykge1xuICAgIHZhciB0ID0gKHR5cGVvZiBzKVswXTtcbiAgICByZXR1cm4gdCA9PSAncycgfHwgdCA9PSAnbicgfHwgdCA9PSAnYic7XG59XG5leHBvcnRzLmlzUHJpbWl0aXZlID0gaXNQcmltaXRpdmU7XG5mdW5jdGlvbiBpc0RlZihzKSB7XG4gICAgcmV0dXJuIHMgIT09IHVuZGVmaW5lZDtcbn1cbmV4cG9ydHMuaXNEZWYgPSBpc0RlZjtcbnZhciBlbXB0eU5vZGUgPSB2bm9kZV8xLnZub2RlKCcnLCB7fSwgW10sIHVuZGVmaW5lZCwgdW5kZWZpbmVkKTtcbmZ1bmN0aW9uIHNhbWVWbm9kZSh2bm9kZTEsIHZub2RlMikge1xuICAgIHJldHVybiB2bm9kZTEua2V5ID09PSB2bm9kZTIua2V5ICYmIHZub2RlMS5zZWwgPT09IHZub2RlMi5zZWw7XG59XG5mdW5jdGlvbiBjcmVhdGVLZXlUb09sZElkeChjaGlsZHJlbiwgYmVnaW5JZHgsIGVuZElkeCkge1xuICAgIHZhciBpLCBtYXAgPSB7fSwga2V5LCBjaDtcbiAgICBmb3IgKGkgPSBiZWdpbklkeDsgaSA8PSBlbmRJZHg7ICsraSkge1xuICAgICAgICBjaCA9IGNoaWxkcmVuW2ldO1xuICAgICAgICBpZiAoY2ggIT0gbnVsbCkge1xuICAgICAgICAgICAga2V5ID0gY2gua2V5O1xuICAgICAgICAgICAgaWYgKGlzRGVmKGtleSkpXG4gICAgICAgICAgICAgICAgbWFwW2tleV0gPSBpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtYXA7XG59XG52YXIgaG9va3MgPSBbJ3JlYWQnLCAnY3JlYXRlJywgJ3VwZGF0ZScsICdyZW1vdmUnLCAnZGVzdHJveScsICdwcmUnLCAncG9zdCddO1xuZnVuY3Rpb24gaW5pdChtb2R1bGVzLCBhcGkpIHtcbiAgICB2YXIgaSwgaiwgY2JzID0ge307XG4gICAgZm9yIChpID0gMDsgaSA8IGhvb2tzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIGNic1tob29rc1tpXV0gPSBbXTtcbiAgICAgICAgZm9yIChqID0gMDsgaiA8IG1vZHVsZXMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICAgIHZhciBob29rID0gbW9kdWxlc1tqXVtob29rc1tpXV07XG4gICAgICAgICAgICBpZiAoaXNEZWYoaG9vaykpIHtcbiAgICAgICAgICAgICAgICBjYnNbaG9va3NbaV1dLnB1c2goaG9vayk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gY3JlYXRlUm1DYihjaGlsZEVsbSwgbGlzdGVuZXJzKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBybUNiKCkge1xuICAgICAgICAgICAgaWYgKC0tbGlzdGVuZXJzID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudF8xID0gYXBpLnBhcmVudE5vZGUoY2hpbGRFbG0pO1xuICAgICAgICAgICAgICAgIGFwaS5yZW1vdmVDaGlsZChwYXJlbnRfMSwgY2hpbGRFbG0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbiAgICBmdW5jdGlvbiBjcmVhdGVFbG0odm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSkge1xuICAgICAgICB2YXIgaSwgZGF0YSA9IHZub2RlLmRhdGE7XG4gICAgICAgIGlmIChpc0RlZihkYXRhKSkge1xuICAgICAgICAgICAgaWYgKGlzRGVmKGkgPSBkYXRhLmhvb2spICYmIGlzRGVmKGkgPSBpLmluaXQpKSB7XG4gICAgICAgICAgICAgICAgaSh2bm9kZSk7XG4gICAgICAgICAgICAgICAgZGF0YSA9IHZub2RlLmRhdGE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoaWxkcmVuID0gdm5vZGUuY2hpbGRyZW4sIHNlbCA9IHZub2RlLnNlbDtcbiAgICAgICAgaWYgKHNlbCA9PT0gJyEnKSB7XG4gICAgICAgICAgICBpZiAoIWlzRGVmKHZub2RlLnRleHQpKSB7XG4gICAgICAgICAgICAgICAgdm5vZGUudGV4dCA9ICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdm5vZGUuZWxtID0gYXBpLmNyZWF0ZUNvbW1lbnQodm5vZGUudGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaXNEZWYoc2VsKSkge1xuICAgICAgICAgICAgLy8gUGFyc2Ugc2VsZWN0b3JcbiAgICAgICAgICAgIHZhciBoYXNoSWR4ID0gc2VsLmluZGV4T2YoJyMnKTtcbiAgICAgICAgICAgIHZhciBkb3RJZHggPSBzZWwuaW5kZXhPZignLicsIGhhc2hJZHgpO1xuICAgICAgICAgICAgdmFyIGhhc2ggPSBoYXNoSWR4ID4gMCA/IGhhc2hJZHggOiBzZWwubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGRvdCA9IGRvdElkeCA+IDAgPyBkb3RJZHggOiBzZWwubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIHRhZyA9IGhhc2hJZHggIT09IC0xIHx8IGRvdElkeCAhPT0gLTEgPyBzZWwuc2xpY2UoMCwgTWF0aC5taW4oaGFzaCwgZG90KSkgOiBzZWw7XG4gICAgICAgICAgICB2YXIgZWxtID0gdm5vZGUuZWxtID0gYXBpLmNyZWF0ZUVsZW1lbnQodGFnLCBoYXNoIDwgZG90ID8gc2VsLnNsaWNlKGhhc2ggKyAxLCBkb3QpIDogdW5kZWZpbmVkLCBkb3RJZHggPiAwID8gc2VsLnNsaWNlKGRvdCArIDEpLnJlcGxhY2UoL1xcLi9nLCAnICcpIDogdW5kZWZpbmVkLCBpc0RlZihkYXRhKSA/IGRhdGEubnMgOiB1bmRlZmluZWQpO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGNicy5jcmVhdGUubGVuZ3RoOyArK2kpXG4gICAgICAgICAgICAgICAgY2JzLmNyZWF0ZVtpXShlbXB0eU5vZGUsIHZub2RlKTtcbiAgICAgICAgICAgIGlmIChleHBvcnRzLmlzQXJyYXkoY2hpbGRyZW4pKSB7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaCA9IGNoaWxkcmVuW2ldO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2ggIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXBpLmluc2VydENoaWxkKGVsbSwgY3JlYXRlRWxtKGNoLCBpbnNlcnRlZFZub2RlUXVldWUpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGlzUHJpbWl0aXZlKHZub2RlLnRleHQpKSB7XG4gICAgICAgICAgICAgICAgYXBpLmluc2VydENoaWxkKGVsbSwgYXBpLmNyZWF0ZVRleHROb2RlKHZub2RlLnRleHQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGkgPSB2bm9kZS5kYXRhLmhvb2s7IC8vIFJldXNlIHZhcmlhYmxlXG4gICAgICAgICAgICBpZiAoaXNEZWYoaSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoaS5jcmVhdGUpXG4gICAgICAgICAgICAgICAgICAgIGkuY3JlYXRlKGVtcHR5Tm9kZSwgdm5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChpLmluc2VydClcbiAgICAgICAgICAgICAgICAgICAgaW5zZXJ0ZWRWbm9kZVF1ZXVlLnB1c2godm5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdm5vZGUuZWxtID0gYXBpLmNyZWF0ZVRleHROb2RlKHZub2RlLnRleHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2bm9kZS5lbG07XG4gICAgfVxuICAgIGZ1bmN0aW9uIGFkZFZub2RlcyhwYXJlbnRFbG0sIGJlZm9yZSwgdm5vZGVzLCBzdGFydElkeCwgZW5kSWR4LCBpbnNlcnRlZFZub2RlUXVldWUpIHtcbiAgICAgICAgZm9yICg7IHN0YXJ0SWR4IDw9IGVuZElkeDsgKytzdGFydElkeCkge1xuICAgICAgICAgICAgdmFyIGNoID0gdm5vZGVzW3N0YXJ0SWR4XTtcbiAgICAgICAgICAgIGlmIChjaCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgYXBpLmluc2VydENoaWxkKHBhcmVudEVsbSwgY3JlYXRlRWxtKGNoLCBpbnNlcnRlZFZub2RlUXVldWUpLCBiZWZvcmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIGludm9rZURlc3Ryb3lIb29rKHZub2RlKSB7XG4gICAgICAgIHZhciBpLCBqLCBkYXRhID0gdm5vZGUuZGF0YTtcbiAgICAgICAgaWYgKGlzRGVmKGRhdGEpKSB7XG4gICAgICAgICAgICBpZiAoaXNEZWYoaSA9IGRhdGEuaG9vaykgJiYgaXNEZWYoaSA9IGkuZGVzdHJveSkpXG4gICAgICAgICAgICAgICAgaSh2bm9kZSk7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY2JzLmRlc3Ryb3kubGVuZ3RoOyArK2kpXG4gICAgICAgICAgICAgICAgY2JzLmRlc3Ryb3lbaV0odm5vZGUpO1xuICAgICAgICAgICAgaWYgKGlzRGVmKHZub2RlLmNoaWxkcmVuKSkge1xuICAgICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCB2bm9kZS5jaGlsZHJlbi5sZW5ndGg7ICsraikge1xuICAgICAgICAgICAgICAgICAgICBpID0gdm5vZGUuY2hpbGRyZW5bal07XG4gICAgICAgICAgICAgICAgICAgIGlmIChpICE9IG51bGwgJiYgdHlwZW9mIGkgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGludm9rZURlc3Ryb3lIb29rKGkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIHJlbW92ZVZub2RlcyhwYXJlbnRFbG0sIHZub2Rlcywgc3RhcnRJZHgsIGVuZElkeCkge1xuICAgICAgICBmb3IgKDsgc3RhcnRJZHggPD0gZW5kSWR4OyArK3N0YXJ0SWR4KSB7XG4gICAgICAgICAgICB2YXIgaV8xID0gdm9pZCAwLCBsaXN0ZW5lcnMgPSB2b2lkIDAsIHJtID0gdm9pZCAwLCBjaCA9IHZub2Rlc1tzdGFydElkeF07XG4gICAgICAgICAgICBpZiAoY2ggIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGlmIChpc0RlZihjaC5zZWwpKSB7XG4gICAgICAgICAgICAgICAgICAgIGludm9rZURlc3Ryb3lIb29rKGNoKTtcbiAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXJzID0gY2JzLnJlbW92ZS5sZW5ndGggKyAxO1xuICAgICAgICAgICAgICAgICAgICBybSA9IGNyZWF0ZVJtQ2IoY2guZWxtLCBsaXN0ZW5lcnMpO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGlfMSA9IDA7IGlfMSA8IGNicy5yZW1vdmUubGVuZ3RoOyArK2lfMSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNicy5yZW1vdmVbaV8xXShjaCwgcm0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNEZWYoaV8xID0gY2guZGF0YSkgJiYgaXNEZWYoaV8xID0gaV8xLmhvb2spICYmIGlzRGVmKGlfMSA9IGlfMS5yZW1vdmUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpXzEoY2gsIHJtKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJtKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFwaS5yZW1vdmVDaGlsZChwYXJlbnRFbG0sIGNoLmVsbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIHVwZGF0ZUNoaWxkcmVuKHBhcmVudEVsbSwgb2xkQ2gsIG5ld0NoLCBpbnNlcnRlZFZub2RlUXVldWUpIHtcbiAgICAgICAgdmFyIG9sZFN0YXJ0SWR4ID0gMCwgbmV3U3RhcnRJZHggPSAwO1xuICAgICAgICB2YXIgb2xkRW5kSWR4ID0gb2xkQ2gubGVuZ3RoIC0gMTtcbiAgICAgICAgdmFyIG9sZFN0YXJ0Vm5vZGUgPSBvbGRDaFswXTtcbiAgICAgICAgdmFyIG9sZEVuZFZub2RlID0gb2xkQ2hbb2xkRW5kSWR4XTtcbiAgICAgICAgdmFyIG5ld0VuZElkeCA9IG5ld0NoLmxlbmd0aCAtIDE7XG4gICAgICAgIHZhciBuZXdTdGFydFZub2RlID0gbmV3Q2hbMF07XG4gICAgICAgIHZhciBuZXdFbmRWbm9kZSA9IG5ld0NoW25ld0VuZElkeF07XG4gICAgICAgIHZhciBvbGRLZXlUb0lkeDtcbiAgICAgICAgdmFyIGlkeEluT2xkO1xuICAgICAgICB2YXIgZWxtVG9Nb3ZlO1xuICAgICAgICB2YXIgYmVmb3JlO1xuICAgICAgICB3aGlsZSAob2xkU3RhcnRJZHggPD0gb2xkRW5kSWR4ICYmIG5ld1N0YXJ0SWR4IDw9IG5ld0VuZElkeCkge1xuICAgICAgICAgICAgaWYgKG9sZFN0YXJ0Vm5vZGUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIG9sZFN0YXJ0Vm5vZGUgPSBvbGRDaFsrK29sZFN0YXJ0SWR4XTsgLy8gVm5vZGUgbWlnaHQgaGF2ZSBiZWVuIG1vdmVkIGxlZnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG9sZEVuZFZub2RlID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBvbGRFbmRWbm9kZSA9IG9sZENoWy0tb2xkRW5kSWR4XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5ld1N0YXJ0Vm5vZGUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIG5ld1N0YXJ0Vm5vZGUgPSBuZXdDaFsrK25ld1N0YXJ0SWR4XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5ld0VuZFZub2RlID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBuZXdFbmRWbm9kZSA9IG5ld0NoWy0tbmV3RW5kSWR4XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNhbWVWbm9kZShvbGRTdGFydFZub2RlLCBuZXdTdGFydFZub2RlKSkge1xuICAgICAgICAgICAgICAgIHBhdGNoVm5vZGUob2xkU3RhcnRWbm9kZSwgbmV3U3RhcnRWbm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTtcbiAgICAgICAgICAgICAgICBvbGRTdGFydFZub2RlID0gb2xkQ2hbKytvbGRTdGFydElkeF07XG4gICAgICAgICAgICAgICAgbmV3U3RhcnRWbm9kZSA9IG5ld0NoWysrbmV3U3RhcnRJZHhdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2FtZVZub2RlKG9sZEVuZFZub2RlLCBuZXdFbmRWbm9kZSkpIHtcbiAgICAgICAgICAgICAgICBwYXRjaFZub2RlKG9sZEVuZFZub2RlLCBuZXdFbmRWbm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTtcbiAgICAgICAgICAgICAgICBvbGRFbmRWbm9kZSA9IG9sZENoWy0tb2xkRW5kSWR4XTtcbiAgICAgICAgICAgICAgICBuZXdFbmRWbm9kZSA9IG5ld0NoWy0tbmV3RW5kSWR4XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNhbWVWbm9kZShvbGRTdGFydFZub2RlLCBuZXdFbmRWbm9kZSkpIHtcbiAgICAgICAgICAgICAgICBwYXRjaFZub2RlKG9sZFN0YXJ0Vm5vZGUsIG5ld0VuZFZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpO1xuICAgICAgICAgICAgICAgIGFwaS5pbnNlcnRDaGlsZChwYXJlbnRFbG0sIG9sZFN0YXJ0Vm5vZGUuZWxtLCBhcGkubmV4dFNpYmxpbmcob2xkRW5kVm5vZGUuZWxtKSk7XG4gICAgICAgICAgICAgICAgb2xkU3RhcnRWbm9kZSA9IG9sZENoWysrb2xkU3RhcnRJZHhdO1xuICAgICAgICAgICAgICAgIG5ld0VuZFZub2RlID0gbmV3Q2hbLS1uZXdFbmRJZHhdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2FtZVZub2RlKG9sZEVuZFZub2RlLCBuZXdTdGFydFZub2RlKSkge1xuICAgICAgICAgICAgICAgIHBhdGNoVm5vZGUob2xkRW5kVm5vZGUsIG5ld1N0YXJ0Vm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSk7XG4gICAgICAgICAgICAgICAgYXBpLmluc2VydENoaWxkKHBhcmVudEVsbSwgb2xkRW5kVm5vZGUuZWxtLCBvbGRTdGFydFZub2RlLmVsbSk7XG4gICAgICAgICAgICAgICAgb2xkRW5kVm5vZGUgPSBvbGRDaFstLW9sZEVuZElkeF07XG4gICAgICAgICAgICAgICAgbmV3U3RhcnRWbm9kZSA9IG5ld0NoWysrbmV3U3RhcnRJZHhdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKG9sZEtleVRvSWR4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgb2xkS2V5VG9JZHggPSBjcmVhdGVLZXlUb09sZElkeChvbGRDaCwgb2xkU3RhcnRJZHgsIG9sZEVuZElkeCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlkeEluT2xkID0gb2xkS2V5VG9JZHhbbmV3U3RhcnRWbm9kZS5rZXldO1xuICAgICAgICAgICAgICAgIGlmICghaXNEZWYoaWR4SW5PbGQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFwaS5pbnNlcnRDaGlsZChwYXJlbnRFbG0sIGNyZWF0ZUVsbShuZXdTdGFydFZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpLCBvbGRTdGFydFZub2RlLmVsbSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld1N0YXJ0Vm5vZGUgPSBuZXdDaFsrK25ld1N0YXJ0SWR4XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGVsbVRvTW92ZSA9IG9sZENoW2lkeEluT2xkXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVsbVRvTW92ZS5zZWwgIT09IG5ld1N0YXJ0Vm5vZGUuc2VsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcGkuaW5zZXJ0Q2hpbGQocGFyZW50RWxtLCBjcmVhdGVFbG0obmV3U3RhcnRWbm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKSwgb2xkU3RhcnRWbm9kZS5lbG0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF0Y2hWbm9kZShlbG1Ub01vdmUsIG5ld1N0YXJ0Vm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBvbGRDaFtpZHhJbk9sZF0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcGkuaW5zZXJ0Q2hpbGQocGFyZW50RWxtLCBlbG1Ub01vdmUuZWxtLCBvbGRTdGFydFZub2RlLmVsbSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbmV3U3RhcnRWbm9kZSA9IG5ld0NoWysrbmV3U3RhcnRJZHhdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAob2xkU3RhcnRJZHggPD0gb2xkRW5kSWR4IHx8IG5ld1N0YXJ0SWR4IDw9IG5ld0VuZElkeCkge1xuICAgICAgICAgICAgaWYgKG9sZFN0YXJ0SWR4ID4gb2xkRW5kSWR4KSB7XG4gICAgICAgICAgICAgICAgYmVmb3JlID0gbmV3Q2hbbmV3RW5kSWR4ICsgMV0gPT0gbnVsbCA/IG51bGwgOiBuZXdDaFtuZXdFbmRJZHggKyAxXS5lbG07XG4gICAgICAgICAgICAgICAgYWRkVm5vZGVzKHBhcmVudEVsbSwgYmVmb3JlLCBuZXdDaCwgbmV3U3RhcnRJZHgsIG5ld0VuZElkeCwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlbW92ZVZub2RlcyhwYXJlbnRFbG0sIG9sZENoLCBvbGRTdGFydElkeCwgb2xkRW5kSWR4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBwYXRjaFZub2RlKG9sZFZub2RlLCB2bm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKSB7XG4gICAgICAgIHZhciBpLCBob29rO1xuICAgICAgICBpZiAoaXNEZWYoaSA9IHZub2RlLmRhdGEpICYmIGlzRGVmKGhvb2sgPSBpLmhvb2spICYmIGlzRGVmKGkgPSBob29rLnByZXBhdGNoKSkge1xuICAgICAgICAgICAgaShvbGRWbm9kZSwgdm5vZGUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBlbG0gPSB2bm9kZS5lbG0gPSBvbGRWbm9kZS5lbG07XG4gICAgICAgIHZhciBvbGRDaCA9IG9sZFZub2RlLmNoaWxkcmVuO1xuICAgICAgICB2YXIgY2ggPSB2bm9kZS5jaGlsZHJlbjtcbiAgICAgICAgaWYgKG9sZFZub2RlID09PSB2bm9kZSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaWYgKGlzRGVmKHZub2RlLmRhdGEpKSB7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY2JzLnVwZGF0ZS5sZW5ndGg7ICsraSlcbiAgICAgICAgICAgICAgICBjYnMudXBkYXRlW2ldKG9sZFZub2RlLCB2bm9kZSk7XG4gICAgICAgICAgICBpID0gdm5vZGUuZGF0YS5ob29rO1xuICAgICAgICAgICAgaWYgKGlzRGVmKGkpICYmIGlzRGVmKGkgPSBpLnVwZGF0ZSkpXG4gICAgICAgICAgICAgICAgaShvbGRWbm9kZSwgdm5vZGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNEZWYodm5vZGUudGV4dCkpIHtcbiAgICAgICAgICAgIGlmIChpc0RlZihvbGRDaCkgJiYgaXNEZWYoY2gpKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9sZENoICE9PSBjaClcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlQ2hpbGRyZW4oZWxtLCBvbGRDaCwgY2gsIGluc2VydGVkVm5vZGVRdWV1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpc0RlZihjaCkpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNEZWYob2xkVm5vZGUudGV4dCkpXG4gICAgICAgICAgICAgICAgICAgIGFwaS5zZXRUZXh0Q29udGVudChlbG0sICcnKTtcbiAgICAgICAgICAgICAgICBhZGRWbm9kZXMoZWxtLCBudWxsLCBjaCwgMCwgY2gubGVuZ3RoIC0gMSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGlzRGVmKG9sZENoKSkge1xuICAgICAgICAgICAgICAgIHJlbW92ZVZub2RlcyhlbG0sIG9sZENoLCAwLCBvbGRDaC5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGlzRGVmKG9sZFZub2RlLnRleHQpKSB7XG4gICAgICAgICAgICAgICAgYXBpLnNldFRleHRDb250ZW50KGVsbSwgJycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG9sZFZub2RlLnRleHQgIT09IHZub2RlLnRleHQpIHtcbiAgICAgICAgICAgIGFwaS5zZXRUZXh0Q29udGVudChlbG0sIHZub2RlLnRleHQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc0RlZihob29rKSAmJiBpc0RlZihpID0gaG9vay5wb3N0cGF0Y2gpKSB7XG4gICAgICAgICAgICBpKG9sZFZub2RlLCB2bm9kZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gcGF0Y2gob2xkVm5vZGUsIHZub2RlKSB7XG4gICAgICAgIHZhciBpO1xuICAgICAgICB2YXIgaW5zZXJ0ZWRWbm9kZVF1ZXVlID0gW107XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBjYnMucHJlLmxlbmd0aDsgKytpKVxuICAgICAgICAgICAgY2JzLnByZVtpXSgpO1xuICAgICAgICBpZiAoc2FtZVZub2RlKG9sZFZub2RlLCB2bm9kZSkpIHtcbiAgICAgICAgICAgIHBhdGNoVm5vZGUob2xkVm5vZGUsIHZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGVsbSA9IG9sZFZub2RlLmVsbTtcbiAgICAgICAgICAgIHZhciBwYXJlbnRfMiA9IGFwaS5wYXJlbnROb2RlKGVsbSk7XG4gICAgICAgICAgICBjcmVhdGVFbG0odm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSk7XG4gICAgICAgICAgICBpZiAocGFyZW50XzIgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBhcGkuaW5zZXJ0Q2hpbGQocGFyZW50XzIsIHZub2RlLmVsbSwgYXBpLm5leHRTaWJsaW5nKGVsbSkpO1xuICAgICAgICAgICAgICAgIHJlbW92ZVZub2RlcyhwYXJlbnRfMiwgW29sZFZub2RlXSwgMCwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGluc2VydGVkVm5vZGVRdWV1ZS5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgaW5zZXJ0ZWRWbm9kZVF1ZXVlW2ldLmRhdGEuaG9vay5pbnNlcnQoaW5zZXJ0ZWRWbm9kZVF1ZXVlW2ldKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY2JzLnBvc3QubGVuZ3RoOyArK2kpXG4gICAgICAgICAgICBjYnMucG9zdFtpXSgpO1xuICAgICAgICByZXR1cm4gdm5vZGU7XG4gICAgfVxuICAgIDtcbiAgICBmdW5jdGlvbiByZWFkKG5vZGUpIHtcbiAgICAgICAgdmFyIHRleHQ7XG4gICAgICAgIGlmIChhcGkuaXNFbGVtZW50KG5vZGUpKSB7XG4gICAgICAgICAgICB2YXIgX2EgPSBhcGkuZ2V0U2VsZWN0b3Iobm9kZSksIHRhZyA9IF9hWzBdLCBpZCA9IF9hWzFdLCBjbHMgPSBfYVsyXTtcbiAgICAgICAgICAgIHZhciBzZWwgPSBcIlwiICsgdGFnICsgKGlkID8gJyMnICsgaWQgOiAnJykgKyAoY2xzID8gJy4nICsgY2xzLnJlcGxhY2UoLyAvLCAnLicpIDogJycpO1xuICAgICAgICAgICAgdmFyIGNoaWxkcmVuID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBjaGlsZCA9IGFwaS5maXJzdENoaWxkKG5vZGUpOyBjaGlsZCAhPSBudWxsOyBjaGlsZCA9IGFwaS5uZXh0U2libGluZyhjaGlsZCkpIHtcbiAgICAgICAgICAgICAgICBjaGlsZHJlbi5wdXNoKHJlYWQoY2hpbGQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2biA9IHZub2RlXzEudm5vZGUoc2VsLCB7fSwgY2hpbGRyZW4sIHVuZGVmaW5lZCwgbm9kZSk7XG4gICAgICAgICAgICBmb3IgKHZhciBpXzIgPSAwOyBpXzIgPCBjYnMucmVhZC5sZW5ndGg7ICsraV8yKVxuICAgICAgICAgICAgICAgIGNicy5yZWFkW2lfMl0odm4pO1xuICAgICAgICAgICAgcmV0dXJuIHZuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGFwaS5pc1RleHQobm9kZSkpIHtcbiAgICAgICAgICAgIHRleHQgPSBhcGkuZ2V0VGV4dENvbnRlbnQobm9kZSk7XG4gICAgICAgICAgICByZXR1cm4gdm5vZGVfMS52bm9kZSh1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB0ZXh0LCBub2RlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhcGkuaXNDb21tZW50KG5vZGUpKSB7XG4gICAgICAgICAgICB0ZXh0ID0gYXBpLmdldFRleHRDb250ZW50KG5vZGUpO1xuICAgICAgICAgICAgcmV0dXJuIHZub2RlXzEudm5vZGUoJyEnLCB7fSwgW10sIHRleHQsIG5vZGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHZub2RlXzEudm5vZGUoJycsIHt9LCBbXSwgdW5kZWZpbmVkLCBub2RlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4geyByZWFkOiByZWFkLCBwYXRjaDogcGF0Y2ggfTtcbn1cbmV4cG9ydHMuaW5pdCA9IGluaXQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zbmFiYmRvbS5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmZ1bmN0aW9uIHZub2RlKHNlbCwgZGF0YSwgY2hpbGRyZW4sIHRleHQsIGVsbSkge1xuICAgIHZhciBrZXkgPSBkYXRhID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiBkYXRhLmtleTtcbiAgICByZXR1cm4ge1xuICAgICAgICBzZWw6IHNlbCwgZGF0YTogZGF0YSwgY2hpbGRyZW46IGNoaWxkcmVuLFxuICAgICAgICB0ZXh0OiB0ZXh0LCBlbG06IGVsbSwga2V5OiBrZXlcbiAgICB9O1xufVxuZXhwb3J0cy52bm9kZSA9IHZub2RlO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm5vZGU7XG4vLyMgc291cmNlTWFwcGluZ1VSTD12bm9kZS5qcy5tYXAiXX0=\n"]}